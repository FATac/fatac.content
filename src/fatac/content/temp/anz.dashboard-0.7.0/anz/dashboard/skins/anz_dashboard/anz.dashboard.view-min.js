
/* - anzi18n.js - */
Ext.namespace("Anz");Anz.i18n={};function _(a){if(Anz.i18n[a]){a=Anz.i18n[a]}return a}var Utf8={encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};
/* - anz_widget.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.base=Ext.extend(Ext.Panel,{draggable:true,loaded:false,maxRetryTimes:6,options:null,retried:0,cls:"x-widget",frame:false,style:"margin: 5px 0 0",initComponent:function(){Anz.widget.base.superclass.initComponent.call(this);var a=this.initialConfig;this.options=a.options;this.portalUrl=a.portalUrl;this.contextUrl=a.contextUrl;this.on({render:{scope:this,fn:function(b){if(!this.collapsed){this.display()}}},expand:{scope:this,fn:function(b){if(!this.loaded){this.display()}}}})},getCommonPreferences:function(){return[{xtype:"textfield",name:"title",fieldLabel:_("Title"),value:"Widget title"},{xtype:"xcheckbox",name:"showTitle",fieldLabel:_("Show title?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"showTitle:int"}]},getCustomisePreferences:function(){return[]},getPreferences:function(){return this.getCommonPreferences().concat(this.getCustomisePreferences())},updateOptions:function(a){},display:function(){},retryDisplay:function(){if(!this.loaded){if(this.retried<this.maxRetryTimes){this.retried+=1;this.display.defer(Math.pow(2,this.retried)*1000,this)}else{this.body.update(_("Sorry, we can not get data successfully now, you should refresh the whole page later to try again."))}}},getValue:function(b){var a=this.options[b];if(a===undefined){a=this.getDefaultValues()[b]}return a},getDefaultValues:function(){return{}}});
/* - widget_static_text.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.staticText=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_postit_icon",getCustomisePreferences:function(){return[{xtype:"htmleditor",name:"text",fieldLabel:_("body"),value:_("Type text here")}]},updateOptions:function(a){this.options=a;this.setTitle(Utf8.decode(a.title));this.display()},display:function(){var a=this.getValue("text");if(!a){a=_("Type text here")}this.body.update(Utf8.decode(a))},convertTextToHTML:function(a){a=a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/  /g,"&nbsp; ");return a},convertHTMLToText:function(a){a=a.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/&gt;/g,">").replace(/<br>/g,"\n").replace(/\&nbsp;/g," ");return a}});Ext.reg("widget_static_text",Anz.widget.staticText);
/* - widget_rss.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.rss=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_rss_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){return[{xtype:"textfield",name:"feed",fieldLabel:_("Feed"),value:""},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{count:5,paging:1,view:"Normal"}},updateOptions:function(d){var b=this.options;this.options=d;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var e=b.feed;var c=b.view;var a=b.paging;if(e!==this.getValue("feed")){this.display()}else{if(c!==this.getValue("view")||a!==this.getValue("paging")){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var b=this.getValue("feed");var a=this.getValue("count");Ext.Ajax.request({url:this.initialConfig.contextUrl+"/@@rssWidget/entries",method:"POST",params:{url:b,"count:int":a},timeout:5000,scope:this,success:function(c,e){var d=Ext.decode(c.responseText);if(d.success){this.entries=d.entries;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(d.entries.length/this.count);this.buildContents();this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(c,e){var d=c.responseText;if(d){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var h=this.page*this.count;var c=this.entries.slice(h,h+this.count);var f='<ul class="feedList">';var b=new Ext.Template("<li>",'<a href="{link}" title="{desc}" target="_blank">','{title}<span class="feedItemDate"> - {date}</span>',"</a>","</li>");for(var e=0,a=c.length;e<a;++e){var g=c[e];var d=this.convertDate(g.updated);f+=b.applyTemplate({title:g.title,desc:g.summary,link:g.link,date:this.getTimeDiff(d)})}f+="</ul>";return f},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({title:c.title,desc:c.summary,img:this.portalUrl+"/default_news.png",link:c.link,date:this.getTimeDiff(j)}));d.push('<div class="right">');var h=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>",'<div class="description">',"<p>{desc}</p>","</div>","</div>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({title:k.title,desc:k.summary,img:this.portalUrl+"/default_news.png",link:k.link,date:this.getTimeDiff(j)}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(){var c=this.entries;var d=this.getId()+"_slideshow";var g=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<div class="description">','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>","</div>");for(var f=0,a=c.length;f<a;++f){var h=c[f];var e=this.convertDate(h.updated);g.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:h.title,desc:h.summary,link:h.link,date:this.getTimeDiff(e)}))}g.push("</div>");return g.join("")},buildHeadlineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>","</div>",'<div class="middle odd">','<div class="description">{desc}</div>',"</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.summary,link:c.link,date:this.getTimeDiff(j)}));d.push('<ul class="bottom">');var h=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}<small class="feedItemDate">{date}</small></a></h3>','<p class="description">{desc}</p>',"</li>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:k.title,desc:k.summary,link:k.link,date:this.getTimeDiff(j)}))}d.push("</ul></div>");return d.join("")},convertDate:function(a){var b=null;if(a){b=a.split("-").join("/")}return b},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+_("days before")}else{if(f>0){a=f+_("hours before")}else{if(b>0){a=b+_("minutes before")}}}return a}});Ext.reg("widget_rss",Anz.widget.rss);
/* - widget_weather.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.weather=Ext.extend(Anz.widget.base,{iconCls:"widget_weather_icon",getCustomisePreferences:function(){return[{xtype:"widget.weather.woeidfield",name:"woeid",fieldLabel:_("City"),value:""},{xtype:"combo",name:"units",hiddenName:"units",fieldLabel:_("Units"),value:"c",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["c",_("Celsius")],["f",_("Fahrenheit")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Compact",_("Compact")],["Today",_("Today")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.woeid;var e=a.units;var b=a.view;if(d!==c.woeid){this.display()}else{if(e!==c.units){this.display()}else{if(b!==c.view){this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');var a=this.getValue("feed");Ext.Ajax.request({url:this.contextUrl+"/@@weatherWidget/weather",method:"POST",params:{woeid:this.options.woeid,units:this.options.units},timeout:5000,scope:this,success:function(b,f){var d=Ext.decode(b.responseText);if(d.success){var g=d.info;var c=this.options.view;var e=this.buildContents(g,c);this.body.update(e);this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(b,d){var c=b.responseText;if(c){this.body.update(c.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},buildContents:function(a,b){var c=null;switch(b){case"Compact":c=this.buildCompactHtml(a);break;case"Today":c=this.buildTodayHtml(a);break;default:c=this.buildTodayHtml(a)}return c},buildTodayHtml:function(b){var a=new Ext.Template('<div class="yw-forecast">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="yw-date">{time}</div>','<div class="yw-cond">{condition_text}</div>',"<dl>","<dt>{Feels_Like}:</dt><dd>{temp}&deg;{temp_unit}</dd>","<dt>{Barometer}:</dt><dd>{pressure} {pressure_unit}</dd>","<dt>{Humidity}:</dt><dd>{humidity} %</dd>","<dt>{Visibility}:</dt><dd>{visibility} {visibility_unit}</dd>","<dt>{Wind}:</dt><dd>{wind_direction} {wind_speed} {speed_unit}</dd>","<dt>{Sunrise}:</dt><dd>{sunrise}</dd>","<dt>{Sunset}:</dt><dd>{sunset}</dd>","</dl>",'<div class="forecast-icon" style="background: transparent url(images/weather/{code}d-s.png) no-repeat scroll 0% 0%;"></div>','<div class="forecast-temp">','<div class="yw-temp">{temp}&deg;</div>',"<p>{High}: {high_temp}&deg; {Low}: {low_temp}&deg;</p>","</div>","</div>");return a.applyTemplate({Feels_Like:_("Feels Like"),Barometer:_("Barometer"),Humidity:_("Humidity"),Visibility:_("Visibility"),Wind:_("Wind"),Sunrise:_("Sunrise"),Sunset:_("Sunset"),High:_("High"),Low:_("Low"),location:b.location.city+","+b.location.country,time:b.condition.date,condition_text:this._conditionMap()[b.condition.code],temp:b.condition.temp,temp_unit:b.units.temperature,pressure:b.atmosphere.pressure,pressure_unit:b.units.pressure,humidity:b.atmosphere.humidity,visibility:b.atmosphere.visibility,visibility_unit:b.units.distance,wind_direction:b.wind.direction,wind_speed:b.wind.speed,speed_unit:b.units.speed,sunrise:b.astronomy.sunrise,sunset:b.astronomy.sunset,high_temp:b.forecast[0].high,low_temp:b.forecast[0].low,code:b.condition.code,link:b.link,Detailed_Forecast:_("Detailed Forecast")})},buildCompactHtml:function(b){var a=new Ext.Template('<div class="weather-compact">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="today-weather">','<div class="weather-icon">','<img src="images/weather/{today_code}d-s.png" title="{today_code_text}" alt="{condition_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{today_date}<br>{today_weekday}</span>','<span class="weather-temp">{today_low_temp}/{today_high_temp}&deg;</span>',"</div>","</div>",'<div class="tomorrow-weather">','<div class="weather-icon">','<img src="images/weather/{next_code}d-s.png" title="{next_code_text}" alt="{next_code_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{next_weekday}</span>','<span class="weather-temp">{next_low_temp}/{next_high_temp}&deg;</span>',"</div>","</div>","</div>");return a.applyTemplate({link:b.link,location:b.location.city+","+b.location.country,today_code:b.forecast[0].code,today_code_text:this._conditionMap()[b.forecast[0].code],today_low_temp:b.forecast[0].low,today_high_temp:b.forecast[0].high,today_date:b.forecast[0].date,today_weekday:_(b.forecast[0].day),next_code:b.forecast[1].code,next_code_text:this._conditionMap()[b.forecast[1].code],next_low_temp:b.forecast[1].low,next_high_temp:b.forecast[1].high,next_date:b.forecast[1].date,next_weekday:_(b.forecast[1].day)})},_conditionMap:function(){return{"0":_("Tornado"),"1":_("Tropical storm"),"2":_("Hurricane"),"3":_("Severe thunderstorms"),"4":_("Thunderstorms"),"5":_("Mixed rain and snow"),"6":_("Mixed rain and sleet"),"7":_("Mixed snow and sleet"),"8":_("Freezing drizzle"),"9":_("Drizzle"),"10":_("Freezing rain"),"11":_("Showers"),"12":_("Showers"),"13":_("Snow flurries"),"14":_("Light snow showers"),"15":_("Blowing snow"),"16":_("Snow"),"17":_("Hail"),"18":_("Sleet"),"19":_("Dust"),"20":_("Foggy"),"21":_("Haze"),"22":_("Smoky"),"23":_("Blustery"),"24":_("Windy"),"25":_("Cold"),"26":_("Cloudy"),"27":_("Mostly cloudy"),"28":_("Mostly cloudy"),"29":_("Partly cloudy"),"30":_("Partly cloudy"),"31":_("Clear"),"32":_("Sunny"),"33":_("Fair"),"34":_("Fair"),"35":_("Mixed rain and hail"),"36":_("Hot"),"37":_("Isolated thunderstorms"),"38":_("Scattered thunderstorms"),"39":_("Scattered thunderstorms"),"40":_("Scattered showers"),"41":_("Heavy snow"),"42":_("Scattered snow showers"),"43":_("Heavy snow"),"44":_("Partly cloudy"),"45":_("Thundershowers"),"46":_("Snow showers"),"47":_("Isolated thundershowers")}}});Ext.reg("widget_weather",Anz.widget.weather);Anz.widget.weather.woeidfield=function(b){var c=new Ext.data.Store({proxy:new Ext.data.ScriptTagProxy({url:"http://where.yahooapis.com/v1",listeners:{beforeload:{scope:this,fn:function(e,f){e.setApi(Ext.data.Api.actions.read,String.format("http://where.yahooapis.com/v1/places.q({0});count=0?format=json&appid=1dIus9DV34GjOFTpNt_pwV465FOtJItUDeDMDR2bLWox6hTqUHPrVtvCnvDBfYg-",f.query))}}}}),reader:new Ext.data.JsonReader({root:"places.place",id:"woeid"},[{name:"woeid",mapping:"woeid"},{name:"name",mapping:"name"}])});var d=new Ext.XTemplate('<tpl for="."><div class="search-item">',"<h3><span>{woeid}-{name}</span></h3>","</div></tpl>");var a={store:c,displayField:"title",typeAhead:false,loadingText:"Searching...",width:570,hideTrigger:true,tpl:d,itemSelector:"div.search-item",listeners:{select:{scope:this,fn:function(g,e,f){g.setValue(e.get("woeid"))}}}};if(b){Ext.apply(a,b)}Ext.apply(this,a);Anz.widget.weather.woeidfield.superclass.constructor.apply(this,arguments)};Ext.extend(Anz.widget.weather.woeidfield,Ext.form.ComboBox,{});Ext.reg("widget.weather.woeidfield",Anz.widget.weather.woeidfield);
/* - widget_calendar.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.calendar=Ext.extend(Anz.widget.base,{iconCls:"widget_calendar_icon",bodyStyle:"padding: 5px",view:"Month",tips:[],tipsCfg:[],getCustomisePreferences:function(){return[{xtype:"combo",name:"weekStart",hiddenName:"weekStart",fieldLabel:_("Start day of week"),value:"Mon",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Sun",_("Sun")],["Mon",_("Mon")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Month",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Month",_("Month")],["Week",_("Week")],["Agenda",_("Agenda")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{view:"Month",weekStart:"Mon"}},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.weekStart;var b=a.view;if(d!==c.weekStart){this.display()}else{if(b!==c.view){this.display()}}}},display:function(c){this.body.update('<div class="loading-indicator">Loading...</div>');if(!c){c=new Date()}this.view=this.getValue("view");this.weekStart=this.getValue("weekStart");var d=null;var a=null;switch(this.view){case"Month":d=c.getFirstDateOfMonth();a=c.getLastDateOfMonth();break;case"Week":case"Agenda":var b=c.format("w");if(this.weekStart=="Sun"){d=c.add(Date.DAY,-b)}else{if(b==0){d=c.add(Date.DAY,-6)}else{d=c.add(Date.DAY,1-b)}}a=d.add(Date.DAY,6);break;default:break}Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["events@@calendarWidget/events?start:date="+d.format("Y/m/d")+"&end:date="+a.format("Y/m/d"),"stateStr@@calendarWidget/getReviewStateString"]},timeout:5000,scope:this,success:function(f,i){var g=Ext.decode(f.responseText);var j=g.events;if(j.success){this.eventsInfo=j.events;this.startDate=d;var e=g.stateStr;if(e.success){this.stateStr=e.stateStr}var h=this.buildContents();this.destroyEventTips();this.body.update(h);this.createEventTips();this.attachListener();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(e,g){var f=e.responseText;if(f){this.body.update(f.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachListener:function(){var a=this.view;switch(a){case"Month":this.buildMonthListener();break;case"Week":case"Agenda":this.buildWeekListener();break;default:break}},destroyEventTips:function(){var b=this.tips;for(var c=0,a=b.length;c<a;++c){Ext.QuickTips.unregister(b[c].target)}this.tips=[]},createEventTips:function(){var e=this.tipsCfg;for(var c=0,a=e.length;c<a;++c){var b=e[c];var d=new Ext.ToolTip({target:b.target,title:_("Events in this day"),width:"auto",dismissDelay:0,html:b.html,trackMouse:true});this.tips.push(d)}this.tipsCfg=[]},buildMonthListener:function(){var a=this.body.child("a[class=preTimeCycle]");a.on("click",this.preMonth,this);var b=this.body.child("a[class=nextTimeCycle]");b.on("click",this.nextMonth,this)},preMonth:function(){var a=this.startDate.add(Date.MONTH,-1);this.display(a)},nextMonth:function(){var a=this.startDate.add(Date.MONTH,1);this.display(a)},buildWeekListener:function(){var b=this.body.child("a[class=preTimeCycle]");b.on("click",this.preWeek,this);var a=this.body.child("a[class=nextTimeCycle]");a.on("click",this.nextWeek,this)},preWeek:function(){var a=this.startDate.add(Date.DAY,-7);this.display(a)},nextWeek:function(){var a=this.startDate.add(Date.DAY,7);this.display(a)},buildContents:function(){var a=this.view;var b=null;switch(a){case"Month":b=this.buildMonthHtml();break;case"Week":b=this.buildWeekHtml();break;case"Agenda":b=this.buildAgendaHtml();break;default:b=this.buildMonthHtml()}return b},buildMonthHtml:function(){var d=this.eventsInfo;var u=this.weekStart;var e=this.startDate;var m=e.getFirstDayOfMonth();var f=e.getLastDayOfMonth();var q=0;var s=0;if(u==="Sun"){q=m;s=6-f}else{if(m===0){q=6;s=0}else{q=m-1;s=7-f}}var r=e.getDaysInMonth();var h=[];for(var z=0;z<q;++z){h.push(0)}for(var z=1;z<=r;++z){h.push(z)}for(var z=0;z<s;++z){h.push(0)}var l=[];var y=new Ext.Template('<div class="calendar_month_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{month}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(u==="Sun"){l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="{dateCls}" id="date_{id}">{day}</td>');var C=new Ext.Template('<td class="{dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var w=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var z=0,A=h.length;z<A;++z){if((z%7)==0){l.push("<tr>")}var x=h[z];if(x==0){l.push('<td class="blank_day"></td>')}else{var o=e.add(Date.DAY,x-1);var n=o.format("w");var p=false;if(n==0||n==6){p=true}var c=d[o.format("Ymd")];var g=c&&c.length;if(g){var b=o.format("Y/m/d");l.push(C.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x,url:this.portalUrl+"/search?"+this.stateStr+"start.query:record:list:date="+b+"+23%3A59%3A59&amp;start.range:record=max&amp;end.query:record:list:date="+b+"+00%3A00%3A00&amp;end.range:record=min"}));var t=[];for(var v=0,k=c.length;v<k;++v){var B=c[v];t.push(w.applyTemplate({title:B.title,start:B.start,end:B.end,desc:B.desc}))}this.tipsCfg.push({target:"date_"+o.format("Y_m_d"),html:t.join("")})}else{l.push(a.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x}))}}if((z%7)==6){l.push("</tr>")}}l.push("</tbody></table></div>");return l.join("")},buildWeekHtml:function(){var b=this.eventsInfo;var n=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(n==="Sun"){h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">{day}</td>');var u=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var q=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var s=0;s<7;++s){var l=e.add(Date.DAY,s);var k=l.format("w");var m=false;if(k==0||k==6){m=true}var c=b[l.format("Ymd")];var f=c&&c.length;if(f){h.push(u.applyTemplate({dateCls:m?"weekend":"",id:l.format("Y_m_d"),day:l.format("d"),url:""}));var o=[];for(var p=0,g=c.length;p<g;++p){var t=c[p];o.push(q.applyTemplate({title:t.title,start:t.start,end:t.end,desc:t.desc}))}this.tipsCfg.push({target:"date_"+l.format("Y_m_d"),html:o.join("")})}}h.push("</tbody></table></div>");return h.join("")},buildAgendaHtml:function(){var b=this.eventsInfo;var o=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<div class="">');h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d")}));var q=new Ext.Template('<div class="{eventCls}">','<span class="{dateCls}">{date}</span>','<span class="dayCls">{day}</span>','<a target="_blank" href="{url}" title="{desc}">{title}</a>',"</div>");var u=new Ext.Template('<div class="{eventCls}">','<span class="dateCls">{date}</span>','<span class="dayCls">{day}</span>','<span class="hint">{title}</span>',"</div>");for(var s=0;s<7;++s){var m=e.add(Date.DAY,s);var k=m.format("w");var n=false;if(k==0||k==6){n=true}var l=m.format("Y/m/d");var a=m.format("D");var c=b[m.format("Ymd")];var f=c&&c.length;if(f){for(var p=0,g=c.length;p<g;++p){var t=c[p];h.push(q.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",dateCls:p==0?"dateCls":"dateHidden",dayCls:p==0?"dayCls":"dayHidden",date:l,day:_(a),url:t.url,title:t.title,desc:t.start+"-"+t.end+"    "+t.title}))}}else{h.push(u.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",date:l,day:_(a),title:_("No event today.")}))}}h.push("</div></div>");return h.join("")}});Ext.reg("widget_calendar",Anz.widget.calendar);
/* - widget_folder_contents.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.folderContents=Ext.extend(Anz.widget.base,{iconCls:"widget_folder_contents_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){var a=this.portalUrl.split("/").pop();return[{xtype:"treecombosuperbox",name:"paths",fieldLabel:_("Paths"),hiddenName:"paths:list",navigateItemsWithTab:true,resizable:true,allowBlank:false,msgTarget:"under",displayFieldTpl:"{text}",value:"/"+a,multiSelect:true,treeWidth:353,treeConfig:{height:110,rootVisible:true,autoScroll:true,root:{nodeType:"async",text:_("Root"),id:"root",expanded:true,path:"/"+a},loader:{url:this.portalUrl+"/@@folderContentsView/getChildNodesData"},listeners:{beforeload:{fn:function(c){var b=c.getOwnerTree().getLoader();b.baseParams.path=c.attributes.path}},click:{fn:function(d,g){var c=d.attributes.path;var i=d.text;var b=this.getCaption(d);var h="";var f="";this.addItemBox(c,i,b,h,f)}}}}},{xtype:"xcheckbox",name:"searchSub",fieldLabel:_("Search sub-directory?"),submitOffValue:0,submitOnValue:1,value:0,hiddenName:"searchSub:int"},{xtype:"multiselect",fieldLabel:_("Types"),name:"types",width:360,height:"auto",allowBlank:true,displayField:"name",valueField:"id",store:new Ext.data.JsonStore({autoDestroy:true,autoLoad:true,url:this.contextUrl+"/@@folderContentsWidget/types",root:"types",fields:["id","name"]})},{xtype:"numberfield",name:"recentDays",fieldLabel:_("Recent days"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"numberfield",name:"sort_limit",fieldLabel:_("Max count"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{searchSub:0,recentDays:0,sort_limit:0,count:5,paging:1,view:"Normal"}},updateOptions:function(i){var a=this.options;this.options=i;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var c=a.paths;var g=a.types;var d=a.searchSub;var h=a.recentDays;var e=a.sort_limit;var f=a.view;var b=a.paging;if((c!==this.getValue("paths"))||(g!==this.getValue("types"))||(d!==this.getValue("searchSub"))||(h!==this.getValue("recentDays"))||(e!==this.getValue("sort_limit"))){this.display()}else{if((f!==this.getValue("view"))||(b!==this.getValue("paging"))){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var d=this.getValue("paths");var b=this.getValue("types");var c=this.getValue("searchSub");var e=this.getValue("recentDays");var a=this.getValue("sort_limit");Ext.Ajax.request({url:this.contextUrl+"/@@folderContentsWidget/items",method:"POST",params:{"paths:list":d,searchSub:c,types:b,"recentDays:int":e,"sort_limit:int":a},timeout:5000,scope:this,success:function(f,h){var g=Ext.decode(f.responseText);if(g.success){this.entries=g.items;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(this.entries.length/this.count);this.buildContents();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(f,h){var g=f.responseText;if(g){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var g=this.page*this.count;var c=this.entries.slice(g,g+this.count);var e='<ul class="itemList">';var b=new Ext.Template("<li>",'<img width="16" height="16" src="{iconSrc}">','<a href="{link}" title="{desc}" target="_blank">',"{title}","</a>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</li>");for(var d=0,a=c.length;d<a;++d){var f=c[d];e+=b.applyTemplate({iconSrc:this.portalUrl+"/"+f.icon,title:f.title,desc:f.desc,link:f.url,authorLink:this.portalUrl+"/author/"+f.author_id,author:f.author,date:f.modified,shortDate:new Date(f.modified).format("Y/m/d")})}e+="</ul>";return e},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}"/>',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");var c=e[0];d.push(f.applyTemplate({title:c.title,desc:c.desc,img:this.portalUrl+"/default_news.png",link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<div class="right">');var g=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","<p>{desc}</p>","</div>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({title:j.title,desc:j.desc,img:this.portalUrl+"/default_news.png",link:j.link,authorLink:portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(c){var c=this.entries;var d=this.getId()+"_slideshow";var f=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");for(var e=0,a=c.length;e<a;++e){var g=c[e];f.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:g.title,desc:g.desc,link:g.link,authorLink:this.portalUrl+"/author/"+g.author_id,author:g.author,date:g.modified,shortDate:new Date(g.modified).format("Y/m/d")}))}f.push("</div>");return f.join("")},buildHeadlineHtml:function(e){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","</div>",'<div class="middle odd">',"<p>{desc}</p>","</div>");var c=e[0];d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.desc,link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<ul class="bottom">');var g=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</li>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:j.title,desc:j.desc,link:j.link,authorLink:this.portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</ul></div>");return d.join("")},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+"days before"}else{if(f>0){a=f+"hours before"}else{if(b>0){a=b+"minutes before"}}}return a}});Ext.reg("widget_folder_contents",Anz.widget.folderContents);
/* - anz_dashboard_view.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.dashboard");Anz.dashboard.view=function(){return{portalUrl:null,contextUrl:null,container:null,init:function(b,a){Ext.QuickTips.init();this.portalUrl=b;this.contextUrl=a;Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["pageLayout@@dashboardView/getPageLayout","layoutCfg@@dashboardView/getLayoutConfig","widgets@@widgetView/getWidgets","i18n@@msgCatalog/catalogMapping?domain=anz.dashboard"]},scope:this,success:function(m,d){var h=Ext.decode(m.responseText);var l=h.pageLayout.layout;var c=h.layoutCfg.config;Anz.i18n=h.i18n.texts;var k=h.widgets.widgets;var j={};for(var e=0,g=k.length;e<g;++e){var f=k[e];j[f.id]=f}this.constructPortal(l,c,j)},failure:function(c,d){alert(c.responseText)}})},destroy:function(){if(this.container){this.container.removeAll()}},constructPortal:function(r,u,p){var d={};if(r==="tile"){Ext.apply(d,{renderTo:"region-content"})}else{var m=Ext.get("region-content");var q=m.getWidth(true);Ext.apply(d,{renderTo:"region-content",activeTab:0,width:q,plain:true,defaults:{autoScroll:true}})}var l=[];for(var v=0,w=u.length;v<w;++v){var f=u[v];var h=f.columns.length;var x={};x.xtype="container";x.title=Utf8.decode(f.title);x.layout="column";x.border=false;x.autoHeight=true;var y=[];for(var t=0;t<h;++t){var c=f.columns[t];var g={};g.xtype="container",g.border=false;g.columnWidth=parseFloat(c.width);g.style=c.style;var n=[];var o=c.widgets;var b=o.length;for(var s=0;s<b;++s){var e=o[s];var a={};a.portalUrl=this.portalUrl;a.contextUrl=this.contextUrl;a.xtype=e.id;a.options=e.options;if(!(e.options.showTitle!==undefined&&e.options.showTitle===0)){a.title=Utf8.decode(e.options.title)}if(!e.collapse){a.collapsed=e.collapse;a.draggable=false;if(e.color){a.baseCls="x-panel-green"}if(p[e.id]){a.iconCls=p[e.id].icon}n.push(a)}}g.items=n;y.push(g)}x.items=y;l.push(x)}d.items=l;if(r==="tile"){this.container=new Ext.Container(d)}else{this.container=new Ext.TabPanel(d)}}}}();
/* - anzi18n.js - */
Ext.namespace("Anz");Anz.i18n={};function _(a){if(Anz.i18n[a]){a=Anz.i18n[a]}return a}var Utf8={encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};
/* - anz_widget.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.base=Ext.extend(Ext.Panel,{draggable:true,loaded:false,maxRetryTimes:6,options:null,retried:0,cls:"x-widget",frame:false,style:"margin: 5px 0 0",initComponent:function(){Anz.widget.base.superclass.initComponent.call(this);var a=this.initialConfig;this.options=a.options;this.portalUrl=a.portalUrl;this.contextUrl=a.contextUrl;this.on({render:{scope:this,fn:function(b){if(!this.collapsed){this.display()}}},expand:{scope:this,fn:function(b){if(!this.loaded){this.display()}}}})},getCommonPreferences:function(){return[{xtype:"textfield",name:"title",fieldLabel:_("Title"),value:"Widget title"},{xtype:"xcheckbox",name:"showTitle",fieldLabel:_("Show title?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"showTitle:int"}]},getCustomisePreferences:function(){return[]},getPreferences:function(){return this.getCommonPreferences().concat(this.getCustomisePreferences())},updateOptions:function(a){},display:function(){},retryDisplay:function(){if(!this.loaded){if(this.retried<this.maxRetryTimes){this.retried+=1;this.display.defer(Math.pow(2,this.retried)*1000,this)}else{this.body.update(_("Sorry, we can not get data successfully now, you should refresh the whole page later to try again."))}}},getValue:function(b){var a=this.options[b];if(a===undefined){a=this.getDefaultValues()[b]}return a},getDefaultValues:function(){return{}}});
/* - widget_static_text.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.staticText=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_postit_icon",getCustomisePreferences:function(){return[{xtype:"htmleditor",name:"text",fieldLabel:_("body"),value:_("Type text here")}]},updateOptions:function(a){this.options=a;this.setTitle(Utf8.decode(a.title));this.display()},display:function(){var a=this.getValue("text");if(!a){a=_("Type text here")}this.body.update(Utf8.decode(a))},convertTextToHTML:function(a){a=a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/  /g,"&nbsp; ");return a},convertHTMLToText:function(a){a=a.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/&gt;/g,">").replace(/<br>/g,"\n").replace(/\&nbsp;/g," ");return a}});Ext.reg("widget_static_text",Anz.widget.staticText);
/* - widget_rss.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.rss=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_rss_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){return[{xtype:"textfield",name:"feed",fieldLabel:_("Feed"),value:""},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{count:5,paging:1,view:"Normal"}},updateOptions:function(d){var b=this.options;this.options=d;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var e=b.feed;var c=b.view;var a=b.paging;if(e!==this.getValue("feed")){this.display()}else{if(c!==this.getValue("view")||a!==this.getValue("paging")){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var b=this.getValue("feed");var a=this.getValue("count");Ext.Ajax.request({url:this.initialConfig.contextUrl+"/@@rssWidget/entries",method:"POST",params:{url:b,"count:int":a},timeout:5000,scope:this,success:function(c,e){var d=Ext.decode(c.responseText);if(d.success){this.entries=d.entries;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(d.entries.length/this.count);this.buildContents();this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(c,e){var d=c.responseText;if(d){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var h=this.page*this.count;var c=this.entries.slice(h,h+this.count);var f='<ul class="feedList">';var b=new Ext.Template("<li>",'<a href="{link}" title="{desc}" target="_blank">','{title}<span class="feedItemDate"> - {date}</span>',"</a>","</li>");for(var e=0,a=c.length;e<a;++e){var g=c[e];var d=this.convertDate(g.updated);f+=b.applyTemplate({title:g.title,desc:g.summary,link:g.link,date:this.getTimeDiff(d)})}f+="</ul>";return f},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({title:c.title,desc:c.summary,img:this.portalUrl+"/default_news.png",link:c.link,date:this.getTimeDiff(j)}));d.push('<div class="right">');var h=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>",'<div class="description">',"<p>{desc}</p>","</div>","</div>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({title:k.title,desc:k.summary,img:this.portalUrl+"/default_news.png",link:k.link,date:this.getTimeDiff(j)}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(){var c=this.entries;var d=this.getId()+"_slideshow";var g=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<div class="description">','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>","</div>");for(var f=0,a=c.length;f<a;++f){var h=c[f];var e=this.convertDate(h.updated);g.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:h.title,desc:h.summary,link:h.link,date:this.getTimeDiff(e)}))}g.push("</div>");return g.join("")},buildHeadlineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>","</div>",'<div class="middle odd">','<div class="description">{desc}</div>',"</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.summary,link:c.link,date:this.getTimeDiff(j)}));d.push('<ul class="bottom">');var h=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}<small class="feedItemDate">{date}</small></a></h3>','<p class="description">{desc}</p>',"</li>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:k.title,desc:k.summary,link:k.link,date:this.getTimeDiff(j)}))}d.push("</ul></div>");return d.join("")},convertDate:function(a){var b=null;if(a){b=a.split("-").join("/")}return b},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+_("days before")}else{if(f>0){a=f+_("hours before")}else{if(b>0){a=b+_("minutes before")}}}return a}});Ext.reg("widget_rss",Anz.widget.rss);
/* - widget_weather.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.weather=Ext.extend(Anz.widget.base,{iconCls:"widget_weather_icon",getCustomisePreferences:function(){return[{xtype:"widget.weather.woeidfield",name:"woeid",fieldLabel:_("City"),value:""},{xtype:"combo",name:"units",hiddenName:"units",fieldLabel:_("Units"),value:"c",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["c",_("Celsius")],["f",_("Fahrenheit")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Compact",_("Compact")],["Today",_("Today")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.woeid;var e=a.units;var b=a.view;if(d!==c.woeid){this.display()}else{if(e!==c.units){this.display()}else{if(b!==c.view){this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');var a=this.getValue("feed");Ext.Ajax.request({url:this.contextUrl+"/@@weatherWidget/weather",method:"POST",params:{woeid:this.options.woeid,units:this.options.units},timeout:5000,scope:this,success:function(b,f){var d=Ext.decode(b.responseText);if(d.success){var g=d.info;var c=this.options.view;var e=this.buildContents(g,c);this.body.update(e);this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(b,d){var c=b.responseText;if(c){this.body.update(c.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},buildContents:function(a,b){var c=null;switch(b){case"Compact":c=this.buildCompactHtml(a);break;case"Today":c=this.buildTodayHtml(a);break;default:c=this.buildTodayHtml(a)}return c},buildTodayHtml:function(b){var a=new Ext.Template('<div class="yw-forecast">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="yw-date">{time}</div>','<div class="yw-cond">{condition_text}</div>',"<dl>","<dt>{Feels_Like}:</dt><dd>{temp}&deg;{temp_unit}</dd>","<dt>{Barometer}:</dt><dd>{pressure} {pressure_unit}</dd>","<dt>{Humidity}:</dt><dd>{humidity} %</dd>","<dt>{Visibility}:</dt><dd>{visibility} {visibility_unit}</dd>","<dt>{Wind}:</dt><dd>{wind_direction} {wind_speed} {speed_unit}</dd>","<dt>{Sunrise}:</dt><dd>{sunrise}</dd>","<dt>{Sunset}:</dt><dd>{sunset}</dd>","</dl>",'<div class="forecast-icon" style="background: transparent url(images/weather/{code}d-s.png) no-repeat scroll 0% 0%;"></div>','<div class="forecast-temp">','<div class="yw-temp">{temp}&deg;</div>',"<p>{High}: {high_temp}&deg; {Low}: {low_temp}&deg;</p>","</div>","</div>");return a.applyTemplate({Feels_Like:_("Feels Like"),Barometer:_("Barometer"),Humidity:_("Humidity"),Visibility:_("Visibility"),Wind:_("Wind"),Sunrise:_("Sunrise"),Sunset:_("Sunset"),High:_("High"),Low:_("Low"),location:b.location.city+","+b.location.country,time:b.condition.date,condition_text:this._conditionMap()[b.condition.code],temp:b.condition.temp,temp_unit:b.units.temperature,pressure:b.atmosphere.pressure,pressure_unit:b.units.pressure,humidity:b.atmosphere.humidity,visibility:b.atmosphere.visibility,visibility_unit:b.units.distance,wind_direction:b.wind.direction,wind_speed:b.wind.speed,speed_unit:b.units.speed,sunrise:b.astronomy.sunrise,sunset:b.astronomy.sunset,high_temp:b.forecast[0].high,low_temp:b.forecast[0].low,code:b.condition.code,link:b.link,Detailed_Forecast:_("Detailed Forecast")})},buildCompactHtml:function(b){var a=new Ext.Template('<div class="weather-compact">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="today-weather">','<div class="weather-icon">','<img src="images/weather/{today_code}d-s.png" title="{today_code_text}" alt="{condition_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{today_date}<br>{today_weekday}</span>','<span class="weather-temp">{today_low_temp}/{today_high_temp}&deg;</span>',"</div>","</div>",'<div class="tomorrow-weather">','<div class="weather-icon">','<img src="images/weather/{next_code}d-s.png" title="{next_code_text}" alt="{next_code_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{next_weekday}</span>','<span class="weather-temp">{next_low_temp}/{next_high_temp}&deg;</span>',"</div>","</div>","</div>");return a.applyTemplate({link:b.link,location:b.location.city+","+b.location.country,today_code:b.forecast[0].code,today_code_text:this._conditionMap()[b.forecast[0].code],today_low_temp:b.forecast[0].low,today_high_temp:b.forecast[0].high,today_date:b.forecast[0].date,today_weekday:_(b.forecast[0].day),next_code:b.forecast[1].code,next_code_text:this._conditionMap()[b.forecast[1].code],next_low_temp:b.forecast[1].low,next_high_temp:b.forecast[1].high,next_date:b.forecast[1].date,next_weekday:_(b.forecast[1].day)})},_conditionMap:function(){return{"0":_("Tornado"),"1":_("Tropical storm"),"2":_("Hurricane"),"3":_("Severe thunderstorms"),"4":_("Thunderstorms"),"5":_("Mixed rain and snow"),"6":_("Mixed rain and sleet"),"7":_("Mixed snow and sleet"),"8":_("Freezing drizzle"),"9":_("Drizzle"),"10":_("Freezing rain"),"11":_("Showers"),"12":_("Showers"),"13":_("Snow flurries"),"14":_("Light snow showers"),"15":_("Blowing snow"),"16":_("Snow"),"17":_("Hail"),"18":_("Sleet"),"19":_("Dust"),"20":_("Foggy"),"21":_("Haze"),"22":_("Smoky"),"23":_("Blustery"),"24":_("Windy"),"25":_("Cold"),"26":_("Cloudy"),"27":_("Mostly cloudy"),"28":_("Mostly cloudy"),"29":_("Partly cloudy"),"30":_("Partly cloudy"),"31":_("Clear"),"32":_("Sunny"),"33":_("Fair"),"34":_("Fair"),"35":_("Mixed rain and hail"),"36":_("Hot"),"37":_("Isolated thunderstorms"),"38":_("Scattered thunderstorms"),"39":_("Scattered thunderstorms"),"40":_("Scattered showers"),"41":_("Heavy snow"),"42":_("Scattered snow showers"),"43":_("Heavy snow"),"44":_("Partly cloudy"),"45":_("Thundershowers"),"46":_("Snow showers"),"47":_("Isolated thundershowers")}}});Ext.reg("widget_weather",Anz.widget.weather);Anz.widget.weather.woeidfield=function(b){var c=new Ext.data.Store({proxy:new Ext.data.ScriptTagProxy({url:"http://where.yahooapis.com/v1",listeners:{beforeload:{scope:this,fn:function(e,f){e.setApi(Ext.data.Api.actions.read,String.format("http://where.yahooapis.com/v1/places.q({0});count=0?format=json&appid=1dIus9DV34GjOFTpNt_pwV465FOtJItUDeDMDR2bLWox6hTqUHPrVtvCnvDBfYg-",f.query))}}}}),reader:new Ext.data.JsonReader({root:"places.place",id:"woeid"},[{name:"woeid",mapping:"woeid"},{name:"name",mapping:"name"}])});var d=new Ext.XTemplate('<tpl for="."><div class="search-item">',"<h3><span>{woeid}-{name}</span></h3>","</div></tpl>");var a={store:c,displayField:"title",typeAhead:false,loadingText:"Searching...",width:570,hideTrigger:true,tpl:d,itemSelector:"div.search-item",listeners:{select:{scope:this,fn:function(g,e,f){g.setValue(e.get("woeid"))}}}};if(b){Ext.apply(a,b)}Ext.apply(this,a);Anz.widget.weather.woeidfield.superclass.constructor.apply(this,arguments)};Ext.extend(Anz.widget.weather.woeidfield,Ext.form.ComboBox,{});Ext.reg("widget.weather.woeidfield",Anz.widget.weather.woeidfield);
/* - widget_calendar.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.calendar=Ext.extend(Anz.widget.base,{iconCls:"widget_calendar_icon",bodyStyle:"padding: 5px",view:"Month",tips:[],tipsCfg:[],getCustomisePreferences:function(){return[{xtype:"combo",name:"weekStart",hiddenName:"weekStart",fieldLabel:_("Start day of week"),value:"Mon",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Sun",_("Sun")],["Mon",_("Mon")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Month",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Month",_("Month")],["Week",_("Week")],["Agenda",_("Agenda")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{view:"Month",weekStart:"Mon"}},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.weekStart;var b=a.view;if(d!==c.weekStart){this.display()}else{if(b!==c.view){this.display()}}}},display:function(c){this.body.update('<div class="loading-indicator">Loading...</div>');if(!c){c=new Date()}this.view=this.getValue("view");this.weekStart=this.getValue("weekStart");var d=null;var a=null;switch(this.view){case"Month":d=c.getFirstDateOfMonth();a=c.getLastDateOfMonth();break;case"Week":case"Agenda":var b=c.format("w");if(this.weekStart=="Sun"){d=c.add(Date.DAY,-b)}else{if(b==0){d=c.add(Date.DAY,-6)}else{d=c.add(Date.DAY,1-b)}}a=d.add(Date.DAY,6);break;default:break}Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["events@@calendarWidget/events?start:date="+d.format("Y/m/d")+"&end:date="+a.format("Y/m/d"),"stateStr@@calendarWidget/getReviewStateString"]},timeout:5000,scope:this,success:function(f,i){var g=Ext.decode(f.responseText);var j=g.events;if(j.success){this.eventsInfo=j.events;this.startDate=d;var e=g.stateStr;if(e.success){this.stateStr=e.stateStr}var h=this.buildContents();this.destroyEventTips();this.body.update(h);this.createEventTips();this.attachListener();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(e,g){var f=e.responseText;if(f){this.body.update(f.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachListener:function(){var a=this.view;switch(a){case"Month":this.buildMonthListener();break;case"Week":case"Agenda":this.buildWeekListener();break;default:break}},destroyEventTips:function(){var b=this.tips;for(var c=0,a=b.length;c<a;++c){Ext.QuickTips.unregister(b[c].target)}this.tips=[]},createEventTips:function(){var e=this.tipsCfg;for(var c=0,a=e.length;c<a;++c){var b=e[c];var d=new Ext.ToolTip({target:b.target,title:_("Events in this day"),width:"auto",dismissDelay:0,html:b.html,trackMouse:true});this.tips.push(d)}this.tipsCfg=[]},buildMonthListener:function(){var a=this.body.child("a[class=preTimeCycle]");a.on("click",this.preMonth,this);var b=this.body.child("a[class=nextTimeCycle]");b.on("click",this.nextMonth,this)},preMonth:function(){var a=this.startDate.add(Date.MONTH,-1);this.display(a)},nextMonth:function(){var a=this.startDate.add(Date.MONTH,1);this.display(a)},buildWeekListener:function(){var b=this.body.child("a[class=preTimeCycle]");b.on("click",this.preWeek,this);var a=this.body.child("a[class=nextTimeCycle]");a.on("click",this.nextWeek,this)},preWeek:function(){var a=this.startDate.add(Date.DAY,-7);this.display(a)},nextWeek:function(){var a=this.startDate.add(Date.DAY,7);this.display(a)},buildContents:function(){var a=this.view;var b=null;switch(a){case"Month":b=this.buildMonthHtml();break;case"Week":b=this.buildWeekHtml();break;case"Agenda":b=this.buildAgendaHtml();break;default:b=this.buildMonthHtml()}return b},buildMonthHtml:function(){var d=this.eventsInfo;var u=this.weekStart;var e=this.startDate;var m=e.getFirstDayOfMonth();var f=e.getLastDayOfMonth();var q=0;var s=0;if(u==="Sun"){q=m;s=6-f}else{if(m===0){q=6;s=0}else{q=m-1;s=7-f}}var r=e.getDaysInMonth();var h=[];for(var z=0;z<q;++z){h.push(0)}for(var z=1;z<=r;++z){h.push(z)}for(var z=0;z<s;++z){h.push(0)}var l=[];var y=new Ext.Template('<div class="calendar_month_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{month}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(u==="Sun"){l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="{dateCls}" id="date_{id}">{day}</td>');var C=new Ext.Template('<td class="{dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var w=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var z=0,A=h.length;z<A;++z){if((z%7)==0){l.push("<tr>")}var x=h[z];if(x==0){l.push('<td class="blank_day"></td>')}else{var o=e.add(Date.DAY,x-1);var n=o.format("w");var p=false;if(n==0||n==6){p=true}var c=d[o.format("Ymd")];var g=c&&c.length;if(g){var b=o.format("Y/m/d");l.push(C.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x,url:this.portalUrl+"/search?"+this.stateStr+"start.query:record:list:date="+b+"+23%3A59%3A59&amp;start.range:record=max&amp;end.query:record:list:date="+b+"+00%3A00%3A00&amp;end.range:record=min"}));var t=[];for(var v=0,k=c.length;v<k;++v){var B=c[v];t.push(w.applyTemplate({title:B.title,start:B.start,end:B.end,desc:B.desc}))}this.tipsCfg.push({target:"date_"+o.format("Y_m_d"),html:t.join("")})}else{l.push(a.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x}))}}if((z%7)==6){l.push("</tr>")}}l.push("</tbody></table></div>");return l.join("")},buildWeekHtml:function(){var b=this.eventsInfo;var n=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(n==="Sun"){h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">{day}</td>');var u=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var q=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var s=0;s<7;++s){var l=e.add(Date.DAY,s);var k=l.format("w");var m=false;if(k==0||k==6){m=true}var c=b[l.format("Ymd")];var f=c&&c.length;if(f){h.push(u.applyTemplate({dateCls:m?"weekend":"",id:l.format("Y_m_d"),day:l.format("d"),url:""}));var o=[];for(var p=0,g=c.length;p<g;++p){var t=c[p];o.push(q.applyTemplate({title:t.title,start:t.start,end:t.end,desc:t.desc}))}this.tipsCfg.push({target:"date_"+l.format("Y_m_d"),html:o.join("")})}}h.push("</tbody></table></div>");return h.join("")},buildAgendaHtml:function(){var b=this.eventsInfo;var o=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<div class="">');h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d")}));var q=new Ext.Template('<div class="{eventCls}">','<span class="{dateCls}">{date}</span>','<span class="dayCls">{day}</span>','<a target="_blank" href="{url}" title="{desc}">{title}</a>',"</div>");var u=new Ext.Template('<div class="{eventCls}">','<span class="dateCls">{date}</span>','<span class="dayCls">{day}</span>','<span class="hint">{title}</span>',"</div>");for(var s=0;s<7;++s){var m=e.add(Date.DAY,s);var k=m.format("w");var n=false;if(k==0||k==6){n=true}var l=m.format("Y/m/d");var a=m.format("D");var c=b[m.format("Ymd")];var f=c&&c.length;if(f){for(var p=0,g=c.length;p<g;++p){var t=c[p];h.push(q.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",dateCls:p==0?"dateCls":"dateHidden",dayCls:p==0?"dayCls":"dayHidden",date:l,day:_(a),url:t.url,title:t.title,desc:t.start+"-"+t.end+"    "+t.title}))}}else{h.push(u.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",date:l,day:_(a),title:_("No event today.")}))}}h.push("</div></div>");return h.join("")}});Ext.reg("widget_calendar",Anz.widget.calendar);
/* - widget_folder_contents.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.folderContents=Ext.extend(Anz.widget.base,{iconCls:"widget_folder_contents_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){var a=this.portalUrl.split("/").pop();return[{xtype:"treecombosuperbox",name:"paths",fieldLabel:_("Paths"),hiddenName:"paths:list",navigateItemsWithTab:true,resizable:true,allowBlank:false,msgTarget:"under",displayFieldTpl:"{text}",value:"/"+a,multiSelect:true,treeWidth:353,treeConfig:{height:110,rootVisible:true,autoScroll:true,root:{nodeType:"async",text:_("Root"),id:"root",expanded:true,path:"/"+a},loader:{url:this.portalUrl+"/@@folderContentsView/getChildNodesData"},listeners:{beforeload:{fn:function(c){var b=c.getOwnerTree().getLoader();b.baseParams.path=c.attributes.path}},click:{fn:function(d,g){var c=d.attributes.path;var i=d.text;var b=this.getCaption(d);var h="";var f="";this.addItemBox(c,i,b,h,f)}}}}},{xtype:"xcheckbox",name:"searchSub",fieldLabel:_("Search sub-directory?"),submitOffValue:0,submitOnValue:1,value:0,hiddenName:"searchSub:int"},{xtype:"multiselect",fieldLabel:_("Types"),name:"types",width:360,height:"auto",allowBlank:true,displayField:"name",valueField:"id",store:new Ext.data.JsonStore({autoDestroy:true,autoLoad:true,url:this.contextUrl+"/@@folderContentsWidget/types",root:"types",fields:["id","name"]})},{xtype:"numberfield",name:"recentDays",fieldLabel:_("Recent days"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"numberfield",name:"sort_limit",fieldLabel:_("Max count"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{searchSub:0,recentDays:0,sort_limit:0,count:5,paging:1,view:"Normal"}},updateOptions:function(i){var a=this.options;this.options=i;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var c=a.paths;var g=a.types;var d=a.searchSub;var h=a.recentDays;var e=a.sort_limit;var f=a.view;var b=a.paging;if((c!==this.getValue("paths"))||(g!==this.getValue("types"))||(d!==this.getValue("searchSub"))||(h!==this.getValue("recentDays"))||(e!==this.getValue("sort_limit"))){this.display()}else{if((f!==this.getValue("view"))||(b!==this.getValue("paging"))){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var d=this.getValue("paths");var b=this.getValue("types");var c=this.getValue("searchSub");var e=this.getValue("recentDays");var a=this.getValue("sort_limit");Ext.Ajax.request({url:this.contextUrl+"/@@folderContentsWidget/items",method:"POST",params:{"paths:list":d,searchSub:c,portal_types:b,"recentDays:int":e,"sort_limit:int":a},timeout:5000,scope:this,success:function(f,h){var g=Ext.decode(f.responseText);if(g.success){this.entries=g.items;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(this.entries.length/this.count);this.buildContents();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(f,h){var g=f.responseText;if(g){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var g=this.page*this.count;var c=this.entries.slice(g,g+this.count);var e='<ul class="itemList">';var b=new Ext.Template("<li>",'<img width="16" height="16" src="{iconSrc}">','<a href="{link}" title="{desc}" target="_blank">',"{title}","</a>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</li>");for(var d=0,a=c.length;d<a;++d){var f=c[d];e+=b.applyTemplate({iconSrc:this.portalUrl+"/"+f.icon,title:f.title,desc:f.desc,link:f.url,authorLink:this.portalUrl+"/author/"+f.author_id,author:f.author,date:f.modified,shortDate:new Date(f.modified).format("Y/m/d")})}e+="</ul>";return e},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}"/>',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");var c=e[0];d.push(f.applyTemplate({title:c.title,desc:c.desc,img:this.portalUrl+"/default_news.png",link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<div class="right">');var g=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","<p>{desc}</p>","</div>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({title:j.title,desc:j.desc,img:this.portalUrl+"/default_news.png",link:j.link,authorLink:portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(c){var c=this.entries;var d=this.getId()+"_slideshow";var f=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");for(var e=0,a=c.length;e<a;++e){var g=c[e];f.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:g.title,desc:g.desc,link:g.link,authorLink:this.portalUrl+"/author/"+g.author_id,author:g.author,date:g.modified,shortDate:new Date(g.modified).format("Y/m/d")}))}f.push("</div>");return f.join("")},buildHeadlineHtml:function(e){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","</div>",'<div class="middle odd">',"<p>{desc}</p>","</div>");var c=e[0];d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.desc,link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<ul class="bottom">');var g=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</li>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:j.title,desc:j.desc,link:j.link,authorLink:this.portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</ul></div>");return d.join("")},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+"days before"}else{if(f>0){a=f+"hours before"}else{if(b>0){a=b+"minutes before"}}}return a}});Ext.reg("widget_folder_contents",Anz.widget.folderContents);
/* - anz_dashboard_view.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.dashboard");Anz.dashboard.view=function(){return{portalUrl:null,contextUrl:null,container:null,init:function(b,a){Ext.QuickTips.init();this.portalUrl=b;this.contextUrl=a;Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["pageLayout@@dashboardView/getPageLayout","layoutCfg@@dashboardView/getLayoutConfig","widgets@@widgetView/getWidgets","i18n@@msgCatalog/catalogMapping?domain=anz.dashboard"]},scope:this,success:function(m,d){var h=Ext.decode(m.responseText);var l=h.pageLayout.layout;var c=h.layoutCfg.config;Anz.i18n=h.i18n.texts;var k=h.widgets.widgets;var j={};for(var e=0,g=k.length;e<g;++e){var f=k[e];j[f.id]=f}this.constructPortal(l,c,j)},failure:function(c,d){alert(c.responseText)}})},destroy:function(){if(this.container){this.container.removeAll()}},constructPortal:function(r,u,p){var d={};if(r==="tile"){Ext.apply(d,{renderTo:"region-content"})}else{var m=Ext.get("region-content");var q=m.getWidth(true);Ext.apply(d,{renderTo:"region-content",activeTab:0,width:q,plain:true,defaults:{autoScroll:true}})}var l=[];for(var v=0,w=u.length;v<w;++v){var f=u[v];var h=f.columns.length;var x={};x.xtype="container";x.title=Utf8.decode(f.title);x.layout="column";x.border=false;x.autoHeight=true;var y=[];for(var t=0;t<h;++t){var c=f.columns[t];var g={};g.xtype="container",g.border=false;g.columnWidth=parseFloat(c.width);g.style=c.style;var n=[];var o=c.widgets;var b=o.length;for(var s=0;s<b;++s){var e=o[s];var a={};a.portalUrl=this.portalUrl;a.contextUrl=this.contextUrl;a.xtype=e.id;a.options=e.options;if(!(e.options.showTitle!==undefined&&e.options.showTitle===0)){a.title=Utf8.decode(e.options.title)}if(!e.collapse){a.collapsed=e.collapse;a.draggable=false;if(e.color){a.baseCls="x-panel-green"}if(p[e.id]){a.iconCls=p[e.id].icon}n.push(a)}}g.items=n;y.push(g)}x.items=y;l.push(x)}d.items=l;if(r==="tile"){this.container=new Ext.Container(d)}else{this.container=new Ext.TabPanel(d)}}}}();
/* - anzi18n.js - */
Ext.namespace("Anz");Anz.i18n={};function _(a){if(Anz.i18n[a]){a=Anz.i18n[a]}return a}var Utf8={encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};
/* - anz_widget.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.base=Ext.extend(Ext.Panel,{draggable:true,loaded:false,maxRetryTimes:6,options:null,retried:0,cls:"x-widget",frame:false,style:"margin: 5px 0 0",initComponent:function(){Anz.widget.base.superclass.initComponent.call(this);var a=this.initialConfig;this.options=a.options;this.portalUrl=a.portalUrl;this.contextUrl=a.contextUrl;this.on({render:{scope:this,fn:function(b){if(!this.collapsed){this.display()}}},expand:{scope:this,fn:function(b){if(!this.loaded){this.display()}}}})},getCommonPreferences:function(){return[{xtype:"textfield",name:"title",fieldLabel:_("Title"),value:"Widget title"},{xtype:"xcheckbox",name:"showTitle",fieldLabel:_("Show title?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"showTitle:int"}]},getCustomisePreferences:function(){return[]},getPreferences:function(){return this.getCommonPreferences().concat(this.getCustomisePreferences())},updateOptions:function(a){},display:function(){},retryDisplay:function(){if(!this.loaded){if(this.retried<this.maxRetryTimes){this.retried+=1;this.display.defer(Math.pow(2,this.retried)*1000,this)}else{this.body.update(_("Sorry, we can not get data successfully now, you should refresh the whole page later to try again."))}}},getValue:function(b){var a=this.options[b];if(a===undefined){a=this.getDefaultValues()[b]}return a},getDefaultValues:function(){return{}}});
/* - widget_static_text.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.staticText=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_postit_icon",getCustomisePreferences:function(){return[{xtype:"htmleditor",name:"text",fieldLabel:_("body"),value:_("Type text here")}]},updateOptions:function(a){this.options=a;this.setTitle(Utf8.decode(a.title));this.display()},display:function(){var a=this.getValue("text");if(!a){a=_("Type text here")}this.body.update(Utf8.decode(a))},convertTextToHTML:function(a){a=a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/  /g,"&nbsp; ");return a},convertHTMLToText:function(a){a=a.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/&gt;/g,">").replace(/<br>/g,"\n").replace(/\&nbsp;/g," ");return a}});Ext.reg("widget_static_text",Anz.widget.staticText);
/* - widget_rss.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.rss=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_rss_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){return[{xtype:"textfield",name:"feed",fieldLabel:_("Feed"),value:""},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{count:5,paging:1,view:"Normal"}},updateOptions:function(d){var b=this.options;this.options=d;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var e=b.feed;var c=b.view;var a=b.paging;if(e!==this.getValue("feed")){this.display()}else{if(c!==this.getValue("view")||a!==this.getValue("paging")){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var b=this.getValue("feed");var a=this.getValue("count");Ext.Ajax.request({url:this.initialConfig.contextUrl+"/@@rssWidget/entries",method:"POST",params:{url:b,"count:int":a},timeout:5000,scope:this,success:function(c,e){var d=Ext.decode(c.responseText);if(d.success){this.entries=d.entries;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(d.entries.length/this.count);this.buildContents();this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(c,e){var d=c.responseText;if(d){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var h=this.page*this.count;var c=this.entries.slice(h,h+this.count);var f='<ul class="feedList">';var b=new Ext.Template("<li>",'<a href="{link}" title="{desc}" target="_blank">','{title}<span class="feedItemDate"> - {date}</span>',"</a>","</li>");for(var e=0,a=c.length;e<a;++e){var g=c[e];var d=this.convertDate(g.updated);f+=b.applyTemplate({title:g.title,desc:g.summary,link:g.link,date:this.getTimeDiff(d)})}f+="</ul>";return f},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({title:c.title,desc:c.summary,img:this.portalUrl+"/default_news.png",link:c.link,date:this.getTimeDiff(j)}));d.push('<div class="right">');var h=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>",'<div class="description">',"<p>{desc}</p>","</div>","</div>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({title:k.title,desc:k.summary,img:this.portalUrl+"/default_news.png",link:k.link,date:this.getTimeDiff(j)}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(){var c=this.entries;var d=this.getId()+"_slideshow";var g=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<div class="description">','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>","</div>");for(var f=0,a=c.length;f<a;++f){var h=c[f];var e=this.convertDate(h.updated);g.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:h.title,desc:h.summary,link:h.link,date:this.getTimeDiff(e)}))}g.push("</div>");return g.join("")},buildHeadlineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>","</div>",'<div class="middle odd">','<div class="description">{desc}</div>',"</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.summary,link:c.link,date:this.getTimeDiff(j)}));d.push('<ul class="bottom">');var h=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}<small class="feedItemDate">{date}</small></a></h3>','<p class="description">{desc}</p>',"</li>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:k.title,desc:k.summary,link:k.link,date:this.getTimeDiff(j)}))}d.push("</ul></div>");return d.join("")},convertDate:function(a){var b=null;if(a){b=a.split("-").join("/")}return b},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+_("days before")}else{if(f>0){a=f+_("hours before")}else{if(b>0){a=b+_("minutes before")}}}return a}});Ext.reg("widget_rss",Anz.widget.rss);
/* - widget_weather.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.weather=Ext.extend(Anz.widget.base,{iconCls:"widget_weather_icon",getCustomisePreferences:function(){return[{xtype:"widget.weather.woeidfield",name:"woeid",fieldLabel:_("City"),value:""},{xtype:"combo",name:"units",hiddenName:"units",fieldLabel:_("Units"),value:"c",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["c",_("Celsius")],["f",_("Fahrenheit")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Compact",_("Compact")],["Today",_("Today")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.woeid;var e=a.units;var b=a.view;if(d!==c.woeid){this.display()}else{if(e!==c.units){this.display()}else{if(b!==c.view){this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');var a=this.getValue("feed");Ext.Ajax.request({url:this.contextUrl+"/@@weatherWidget/weather",method:"POST",params:{woeid:this.options.woeid,units:this.options.units},timeout:5000,scope:this,success:function(b,f){var d=Ext.decode(b.responseText);if(d.success){var g=d.info;var c=this.options.view;var e=this.buildContents(g,c);this.body.update(e);this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(b,d){var c=b.responseText;if(c){this.body.update(c.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},buildContents:function(a,b){var c=null;switch(b){case"Compact":c=this.buildCompactHtml(a);break;case"Today":c=this.buildTodayHtml(a);break;default:c=this.buildTodayHtml(a)}return c},buildTodayHtml:function(b){var a=new Ext.Template('<div class="yw-forecast">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="yw-date">{time}</div>','<div class="yw-cond">{condition_text}</div>',"<dl>","<dt>{Feels_Like}:</dt><dd>{temp}&deg;{temp_unit}</dd>","<dt>{Barometer}:</dt><dd>{pressure} {pressure_unit}</dd>","<dt>{Humidity}:</dt><dd>{humidity} %</dd>","<dt>{Visibility}:</dt><dd>{visibility} {visibility_unit}</dd>","<dt>{Wind}:</dt><dd>{wind_direction} {wind_speed} {speed_unit}</dd>","<dt>{Sunrise}:</dt><dd>{sunrise}</dd>","<dt>{Sunset}:</dt><dd>{sunset}</dd>","</dl>",'<div class="forecast-icon" style="background: transparent url(weather/{code}d-s.png) no-repeat scroll 0% 0%;"></div>','<div class="forecast-temp">','<div class="yw-temp">{temp}&deg;</div>',"<p>{High}: {high_temp}&deg; {Low}: {low_temp}&deg;</p>","</div>","</div>");return a.applyTemplate({Feels_Like:_("Feels Like"),Barometer:_("Barometer"),Humidity:_("Humidity"),Visibility:_("Visibility"),Wind:_("Wind"),Sunrise:_("Sunrise"),Sunset:_("Sunset"),High:_("High"),Low:_("Low"),location:b.location.city+","+b.location.country,time:b.condition.date,condition_text:this._conditionMap()[b.condition.code],temp:b.condition.temp,temp_unit:b.units.temperature,pressure:b.atmosphere.pressure,pressure_unit:b.units.pressure,humidity:b.atmosphere.humidity,visibility:b.atmosphere.visibility,visibility_unit:b.units.distance,wind_direction:b.wind.direction,wind_speed:b.wind.speed,speed_unit:b.units.speed,sunrise:b.astronomy.sunrise,sunset:b.astronomy.sunset,high_temp:b.forecast[0].high,low_temp:b.forecast[0].low,code:b.condition.code,link:b.link,Detailed_Forecast:_("Detailed Forecast")})},buildCompactHtml:function(b){var a=new Ext.Template('<div class="weather-compact">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="today-weather">','<div class="weather-icon">','<img src="weather/{today_code}d-s.png" title="{today_code_text}" alt="{condition_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{today_date}<br>{today_weekday}</span>','<span class="weather-temp">{today_low_temp}/{today_high_temp}&deg;</span>',"</div>","</div>",'<div class="tomorrow-weather">','<div class="weather-icon">','<img src="weather/{next_code}d-s.png" title="{next_code_text}" alt="{next_code_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{next_weekday}</span>','<span class="weather-temp">{next_low_temp}/{next_high_temp}&deg;</span>',"</div>","</div>","</div>");return a.applyTemplate({link:b.link,location:b.location.city+","+b.location.country,today_code:b.forecast[0].code,today_code_text:this._conditionMap()[b.forecast[0].code],today_low_temp:b.forecast[0].low,today_high_temp:b.forecast[0].high,today_date:b.forecast[0].date,today_weekday:_(b.forecast[0].day),next_code:b.forecast[1].code,next_code_text:this._conditionMap()[b.forecast[1].code],next_low_temp:b.forecast[1].low,next_high_temp:b.forecast[1].high,next_date:b.forecast[1].date,next_weekday:_(b.forecast[1].day)})},_conditionMap:function(){return{"0":_("Tornado"),"1":_("Tropical storm"),"2":_("Hurricane"),"3":_("Severe thunderstorms"),"4":_("Thunderstorms"),"5":_("Mixed rain and snow"),"6":_("Mixed rain and sleet"),"7":_("Mixed snow and sleet"),"8":_("Freezing drizzle"),"9":_("Drizzle"),"10":_("Freezing rain"),"11":_("Showers"),"12":_("Showers"),"13":_("Snow flurries"),"14":_("Light snow showers"),"15":_("Blowing snow"),"16":_("Snow"),"17":_("Hail"),"18":_("Sleet"),"19":_("Dust"),"20":_("Foggy"),"21":_("Haze"),"22":_("Smoky"),"23":_("Blustery"),"24":_("Windy"),"25":_("Cold"),"26":_("Cloudy"),"27":_("Mostly cloudy"),"28":_("Mostly cloudy"),"29":_("Partly cloudy"),"30":_("Partly cloudy"),"31":_("Clear"),"32":_("Sunny"),"33":_("Fair"),"34":_("Fair"),"35":_("Mixed rain and hail"),"36":_("Hot"),"37":_("Isolated thunderstorms"),"38":_("Scattered thunderstorms"),"39":_("Scattered thunderstorms"),"40":_("Scattered showers"),"41":_("Heavy snow"),"42":_("Scattered snow showers"),"43":_("Heavy snow"),"44":_("Partly cloudy"),"45":_("Thundershowers"),"46":_("Snow showers"),"47":_("Isolated thundershowers")}}});Ext.reg("widget_weather",Anz.widget.weather);Anz.widget.weather.woeidfield=function(b){var c=new Ext.data.Store({proxy:new Ext.data.ScriptTagProxy({url:"http://where.yahooapis.com/v1",listeners:{beforeload:{scope:this,fn:function(e,f){e.setApi(Ext.data.Api.actions.read,String.format("http://where.yahooapis.com/v1/places.q({0});count=0?format=json&appid=1dIus9DV34GjOFTpNt_pwV465FOtJItUDeDMDR2bLWox6hTqUHPrVtvCnvDBfYg-",f.query))}}}}),reader:new Ext.data.JsonReader({root:"places.place",id:"woeid"},[{name:"woeid",mapping:"woeid"},{name:"name",mapping:"name"}])});var d=new Ext.XTemplate('<tpl for="."><div class="search-item">',"<h3><span>{woeid}-{name}</span></h3>","</div></tpl>");var a={store:c,displayField:"title",typeAhead:false,loadingText:"Searching...",width:570,hideTrigger:true,tpl:d,itemSelector:"div.search-item",listeners:{select:{scope:this,fn:function(g,e,f){g.setValue(e.get("woeid"))}}}};if(b){Ext.apply(a,b)}Ext.apply(this,a);Anz.widget.weather.woeidfield.superclass.constructor.apply(this,arguments)};Ext.extend(Anz.widget.weather.woeidfield,Ext.form.ComboBox,{});Ext.reg("widget.weather.woeidfield",Anz.widget.weather.woeidfield);
/* - widget_calendar.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.calendar=Ext.extend(Anz.widget.base,{iconCls:"widget_calendar_icon",bodyStyle:"padding: 5px",view:"Month",tips:[],tipsCfg:[],getCustomisePreferences:function(){return[{xtype:"combo",name:"weekStart",hiddenName:"weekStart",fieldLabel:_("Start day of week"),value:"Mon",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Sun",_("Sun")],["Mon",_("Mon")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Month",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Month",_("Month")],["Week",_("Week")],["Agenda",_("Agenda")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{view:"Month",weekStart:"Mon"}},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.weekStart;var b=a.view;if(d!==c.weekStart){this.display()}else{if(b!==c.view){this.display()}}}},display:function(c){this.body.update('<div class="loading-indicator">Loading...</div>');if(!c){c=new Date()}this.view=this.getValue("view");this.weekStart=this.getValue("weekStart");var d=null;var a=null;switch(this.view){case"Month":d=c.getFirstDateOfMonth();a=c.getLastDateOfMonth();break;case"Week":case"Agenda":var b=c.format("w");if(this.weekStart=="Sun"){d=c.add(Date.DAY,-b)}else{if(b==0){d=c.add(Date.DAY,-6)}else{d=c.add(Date.DAY,1-b)}}a=d.add(Date.DAY,6);break;default:break}Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["events@@calendarWidget/events?start:date="+d.format("Y/m/d")+"&end:date="+a.format("Y/m/d"),"stateStr@@calendarWidget/getReviewStateString"]},timeout:5000,scope:this,success:function(f,i){var g=Ext.decode(f.responseText);var j=g.events;if(j.success){this.eventsInfo=j.events;this.startDate=d;var e=g.stateStr;if(e.success){this.stateStr=e.stateStr}var h=this.buildContents();this.destroyEventTips();this.body.update(h);this.createEventTips();this.attachListener();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(e,g){var f=e.responseText;if(f){this.body.update(f.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachListener:function(){var a=this.view;switch(a){case"Month":this.buildMonthListener();break;case"Week":case"Agenda":this.buildWeekListener();break;default:break}},destroyEventTips:function(){var b=this.tips;for(var c=0,a=b.length;c<a;++c){Ext.QuickTips.unregister(b[c].target)}this.tips=[]},createEventTips:function(){var e=this.tipsCfg;for(var c=0,a=e.length;c<a;++c){var b=e[c];var d=new Ext.ToolTip({target:b.target,title:_("Events in this day"),width:"auto",dismissDelay:0,html:b.html,trackMouse:true});this.tips.push(d)}this.tipsCfg=[]},buildMonthListener:function(){var a=this.body.child("a[class=preTimeCycle]");a.on("click",this.preMonth,this);var b=this.body.child("a[class=nextTimeCycle]");b.on("click",this.nextMonth,this)},preMonth:function(){var a=this.startDate.add(Date.MONTH,-1);this.display(a)},nextMonth:function(){var a=this.startDate.add(Date.MONTH,1);this.display(a)},buildWeekListener:function(){var b=this.body.child("a[class=preTimeCycle]");b.on("click",this.preWeek,this);var a=this.body.child("a[class=nextTimeCycle]");a.on("click",this.nextWeek,this)},preWeek:function(){var a=this.startDate.add(Date.DAY,-7);this.display(a)},nextWeek:function(){var a=this.startDate.add(Date.DAY,7);this.display(a)},buildContents:function(){var a=this.view;var b=null;switch(a){case"Month":b=this.buildMonthHtml();break;case"Week":b=this.buildWeekHtml();break;case"Agenda":b=this.buildAgendaHtml();break;default:b=this.buildMonthHtml()}return b},buildMonthHtml:function(){var d=this.eventsInfo;var u=this.weekStart;var e=this.startDate;var m=e.getFirstDayOfMonth();var f=e.getLastDayOfMonth();var q=0;var s=0;if(u==="Sun"){q=m;s=6-f}else{if(m===0){q=6;s=0}else{q=m-1;s=7-f}}var r=e.getDaysInMonth();var h=[];for(var z=0;z<q;++z){h.push(0)}for(var z=1;z<=r;++z){h.push(z)}for(var z=0;z<s;++z){h.push(0)}var l=[];var y=new Ext.Template('<div class="calendar_month_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{month}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(u==="Sun"){l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="{dateCls}" id="date_{id}">{day}</td>');var C=new Ext.Template('<td class="{dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var w=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var z=0,A=h.length;z<A;++z){if((z%7)==0){l.push("<tr>")}var x=h[z];if(x==0){l.push('<td class="blank_day"></td>')}else{var o=e.add(Date.DAY,x-1);var n=o.format("w");var p=false;if(n==0||n==6){p=true}var c=d[o.format("Ymd")];var g=c&&c.length;if(g){var b=o.format("Y/m/d");l.push(C.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x,url:this.portalUrl+"/search?"+this.stateStr+"start.query:record:list:date="+b+"+23%3A59%3A59&amp;start.range:record=max&amp;end.query:record:list:date="+b+"+00%3A00%3A00&amp;end.range:record=min"}));var t=[];for(var v=0,k=c.length;v<k;++v){var B=c[v];t.push(w.applyTemplate({title:B.title,start:B.start,end:B.end,desc:B.desc}))}this.tipsCfg.push({target:"date_"+o.format("Y_m_d"),html:t.join("")})}else{l.push(a.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x}))}}if((z%7)==6){l.push("</tr>")}}l.push("</tbody></table></div>");return l.join("")},buildWeekHtml:function(){var b=this.eventsInfo;var n=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(n==="Sun"){h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">{day}</td>');var u=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var q=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var s=0;s<7;++s){var l=e.add(Date.DAY,s);var k=l.format("w");var m=false;if(k==0||k==6){m=true}var c=b[l.format("Ymd")];var f=c&&c.length;if(f){h.push(u.applyTemplate({dateCls:m?"weekend":"",id:l.format("Y_m_d"),day:l.format("d"),url:""}));var o=[];for(var p=0,g=c.length;p<g;++p){var t=c[p];o.push(q.applyTemplate({title:t.title,start:t.start,end:t.end,desc:t.desc}))}this.tipsCfg.push({target:"date_"+l.format("Y_m_d"),html:o.join("")})}else{h.push(a.applyTemplate({dateCls:m?"weekend":"",id:l.format("Y_m_d"),day:l.format("d")}))}}h.push("</tbody></table></div>");return h.join("")},buildAgendaHtml:function(){var b=this.eventsInfo;var o=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<div class="">');h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d")}));var q=new Ext.Template('<div class="{eventCls}">','<span class="{dateCls}">{date}</span>','<span class="dayCls">{day}</span>','<a target="_blank" href="{url}" title="{desc}">{title}</a>',"</div>");var u=new Ext.Template('<div class="{eventCls}">','<span class="dateCls">{date}</span>','<span class="dayCls">{day}</span>','<span class="hint">{title}</span>',"</div>");for(var s=0;s<7;++s){var m=e.add(Date.DAY,s);var k=m.format("w");var n=false;if(k==0||k==6){n=true}var l=m.format("Y/m/d");var a=m.format("D");var c=b[m.format("Ymd")];var f=c&&c.length;if(f){for(var p=0,g=c.length;p<g;++p){var t=c[p];h.push(q.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",dateCls:p==0?"dateCls":"dateHidden",dayCls:p==0?"dayCls":"dayHidden",date:l,day:_(a),url:t.url,title:t.title,desc:t.start+"-"+t.end+"    "+t.title}))}}else{h.push(u.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",date:l,day:_(a),title:_("No event today.")}))}}h.push("</div></div>");return h.join("")}});Ext.reg("widget_calendar",Anz.widget.calendar);
/* - widget_folder_contents.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.folderContents=Ext.extend(Anz.widget.base,{iconCls:"widget_folder_contents_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){var a=this.portalUrl.split("/").pop();return[{xtype:"treecombosuperbox",name:"paths",fieldLabel:_("Paths"),hiddenName:"paths:list",navigateItemsWithTab:true,resizable:true,allowBlank:false,msgTarget:"under",displayFieldTpl:"{text}",value:"/"+a,multiSelect:true,treeWidth:353,treeConfig:{height:110,rootVisible:true,autoScroll:true,root:{nodeType:"async",text:_("Root"),id:"root",expanded:true,path:"/"+a},loader:{url:this.portalUrl+"/@@folderContentsView/getChildNodesData"},listeners:{beforeload:{fn:function(c){var b=c.getOwnerTree().getLoader();b.baseParams.path=c.attributes.path}},click:{fn:function(d,g){var c=d.attributes.path;var i=d.text;var b=this.getCaption(d);var h="";var f="";this.addItemBox(c,i,b,h,f)}}}}},{xtype:"xcheckbox",name:"searchSub",fieldLabel:_("Search sub-directory?"),submitOffValue:0,submitOnValue:1,value:0,hiddenName:"searchSub:int"},{xtype:"multiselect",fieldLabel:_("Types"),name:"types",width:360,height:"auto",allowBlank:true,displayField:"name",valueField:"id",store:new Ext.data.JsonStore({autoDestroy:true,autoLoad:true,url:this.contextUrl+"/@@folderContentsWidget/types",root:"types",fields:["id","name"]})},{xtype:"numberfield",name:"recentDays",fieldLabel:_("Recent days"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"numberfield",name:"sort_limit",fieldLabel:_("Max count"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{searchSub:0,recentDays:0,sort_limit:0,count:5,paging:1,view:"Normal"}},updateOptions:function(i){var a=this.options;this.options=i;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var c=a.paths;var g=a.types;var d=a.searchSub;var h=a.recentDays;var e=a.sort_limit;var f=a.view;var b=a.paging;if((c!==this.getValue("paths"))||(g!==this.getValue("types"))||(d!==this.getValue("searchSub"))||(h!==this.getValue("recentDays"))||(e!==this.getValue("sort_limit"))){this.display()}else{if((f!==this.getValue("view"))||(b!==this.getValue("paging"))){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var d=this.getValue("paths");var b=this.getValue("types");var c=this.getValue("searchSub");var e=this.getValue("recentDays");var a=this.getValue("sort_limit");Ext.Ajax.request({url:this.contextUrl+"/@@folderContentsWidget/items",method:"POST",params:{"paths:list":d,searchSub:c,portal_types:b,"recentDays:int":e,"sort_limit:int":a},timeout:5000,scope:this,success:function(f,h){var g=Ext.decode(f.responseText);if(g.success){this.entries=g.items;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(this.entries.length/this.count);this.buildContents();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(f,h){var g=f.responseText;if(g){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var g=this.page*this.count;var c=this.entries.slice(g,g+this.count);var e='<ul class="itemList">';var b=new Ext.Template("<li>",'<img width="16" height="16" src="{iconSrc}">','<a href="{link}" title="{desc}" target="_blank">',"{title}","</a>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</li>");for(var d=0,a=c.length;d<a;++d){var f=c[d];e+=b.applyTemplate({iconSrc:this.portalUrl+"/"+f.icon,title:f.title,desc:f.desc,link:f.url,authorLink:this.portalUrl+"/author/"+f.author_id,author:f.author,date:f.modified,shortDate:new Date(f.modified).format("Y/m/d")})}e+="</ul>";return e},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}"/>',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");var c=e[0];d.push(f.applyTemplate({title:c.title,desc:c.desc,img:this.portalUrl+"/default_news.png",link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<div class="right">');var g=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","<p>{desc}</p>","</div>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({title:j.title,desc:j.desc,img:this.portalUrl+"/default_news.png",link:j.link,authorLink:portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(c){var c=this.entries;var d=this.getId()+"_slideshow";var f=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");for(var e=0,a=c.length;e<a;++e){var g=c[e];f.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:g.title,desc:g.desc,link:g.link,authorLink:this.portalUrl+"/author/"+g.author_id,author:g.author,date:g.modified,shortDate:new Date(g.modified).format("Y/m/d")}))}f.push("</div>");return f.join("")},buildHeadlineHtml:function(e){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","</div>",'<div class="middle odd">',"<p>{desc}</p>","</div>");var c=e[0];d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.desc,link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<ul class="bottom">');var g=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</li>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:j.title,desc:j.desc,link:j.link,authorLink:this.portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</ul></div>");return d.join("")},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+"days before"}else{if(f>0){a=f+"hours before"}else{if(b>0){a=b+"minutes before"}}}return a}});Ext.reg("widget_folder_contents",Anz.widget.folderContents);
/* - anz_dashboard_view.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.dashboard");Anz.dashboard.view=function(){return{portalUrl:null,contextUrl:null,container:null,init:function(b,a){Ext.QuickTips.init();this.portalUrl=b;this.contextUrl=a;Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["pageLayout@@dashboardView/getPageLayout","layoutCfg@@dashboardView/getLayoutConfig","widgets@@widgetView/getWidgets","i18n@@msgCatalog/catalogMapping?domain=anz.dashboard"]},scope:this,success:function(m,d){var h=Ext.decode(m.responseText);var l=h.pageLayout.layout;var c=h.layoutCfg.config;Anz.i18n=h.i18n.texts;var k=h.widgets.widgets;var j={};for(var e=0,g=k.length;e<g;++e){var f=k[e];j[f.id]=f}this.constructPortal(l,c,j)},failure:function(c,d){alert(c.responseText)}})},destroy:function(){if(this.container){this.container.removeAll()}},constructPortal:function(r,u,p){var d={};if(r==="tile"){Ext.apply(d,{renderTo:"region-content"})}else{var m=Ext.get("region-content");var q=m.getWidth(true);Ext.apply(d,{renderTo:"region-content",activeTab:0,width:q,plain:true,defaults:{autoScroll:true}})}var l=[];for(var v=0,w=u.length;v<w;++v){var f=u[v];var h=f.columns.length;var x={};x.xtype="container";x.title=Utf8.decode(f.title);x.layout="column";x.border=false;x.autoHeight=true;var y=[];for(var t=0;t<h;++t){var c=f.columns[t];var g={};g.xtype="container",g.border=false;g.columnWidth=parseFloat(c.width);g.style=c.style;var n=[];var o=c.widgets;var b=o.length;for(var s=0;s<b;++s){var e=o[s];var a={};a.portalUrl=this.portalUrl;a.contextUrl=this.contextUrl;a.xtype=e.id;a.options=e.options;if(!(e.options.showTitle!==undefined&&e.options.showTitle===0)){a.title=Utf8.decode(e.options.title)}if(!e.collapse){a.collapsed=e.collapse;a.draggable=false;if(e.color){a.baseCls="x-panel-green"}if(p[e.id]){a.iconCls=p[e.id].icon}n.push(a)}}g.items=n;y.push(g)}x.items=y;l.push(x)}d.items=l;if(r==="tile"){this.container=new Ext.Container(d)}else{this.container=new Ext.TabPanel(d)}}}}();
/* - anzi18n.js - */
Ext.namespace("Anz");Anz.i18n={};function _(a){if(Anz.i18n[a]){a=Anz.i18n[a]}return a}var Utf8={encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};
/* - anz_widget.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.base=Ext.extend(Ext.Panel,{draggable:true,loaded:false,maxRetryTimes:6,options:null,retried:0,cls:"x-widget",frame:false,style:"margin: 5px 0 0",initComponent:function(){Anz.widget.base.superclass.initComponent.call(this);var a=this.initialConfig;this.options=a.options;this.portalUrl=a.portalUrl;this.contextUrl=a.contextUrl;this.on({render:{scope:this,fn:function(b){if(!this.collapsed){this.display()}}},expand:{scope:this,fn:function(b){if(!this.loaded){this.display()}}}})},getCommonPreferences:function(){return[{xtype:"textfield",name:"title",fieldLabel:_("Title"),value:"Widget title"},{xtype:"xcheckbox",name:"showTitle",fieldLabel:_("Show title?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"showTitle:int"}]},getCustomisePreferences:function(){return[]},getPreferences:function(){return this.getCommonPreferences().concat(this.getCustomisePreferences())},updateOptions:function(a){},display:function(){},retryDisplay:function(){if(!this.loaded){if(this.retried<this.maxRetryTimes){this.retried+=1;this.display.defer(Math.pow(2,this.retried)*1000,this)}else{this.body.update(_("Sorry, we can not get data successfully now, you should refresh the whole page later to try again."))}}},getValue:function(b){var a=this.options[b];if(a===undefined){a=this.getDefaultValues()[b]}return a},getDefaultValues:function(){return{}}});
/* - widget_static_text.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.staticText=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_postit_icon",getCustomisePreferences:function(){return[{xtype:"htmleditor",name:"text",fieldLabel:_("body"),value:_("Type text here")}]},updateOptions:function(a){this.options=a;this.setTitle(Utf8.decode(a.title));this.display()},display:function(){var a=this.getValue("text");if(!a){a=_("Type text here")}else{a=Utf8.decode(a)}this.body.update(a)},convertTextToHTML:function(a){a=a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/  /g,"&nbsp; ");return a},convertHTMLToText:function(a){a=a.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/&gt;/g,">").replace(/<br>/g,"\n").replace(/\&nbsp;/g," ");return a}});Ext.reg("widget_static_text",Anz.widget.staticText);
/* - widget_rss.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.rss=Ext.extend(Anz.widget.base,{bodyStyle:"padding: 5px",iconCls:"widget_rss_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){return[{xtype:"textfield",name:"feed",fieldLabel:_("Feed"),value:""},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{count:5,paging:1,view:"Normal"}},updateOptions:function(d){var b=this.options;this.options=d;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var e=b.feed;var c=b.view;var a=b.paging;if(e!==this.getValue("feed")){this.display()}else{if(c!==this.getValue("view")||a!==this.getValue("paging")){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var b=this.getValue("feed");var a=this.getValue("count");Ext.Ajax.request({url:this.initialConfig.contextUrl+"/@@rssWidget/entries",method:"POST",params:{url:b,"count:int":a},timeout:5000,scope:this,success:function(c,e){var d=Ext.decode(c.responseText);if(d.success){this.entries=d.entries;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(d.entries.length/this.count);this.buildContents();this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(c,e){var d=c.responseText;if(d){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var h=this.page*this.count;var c=this.entries.slice(h,h+this.count);var f='<ul class="feedList">';var b=new Ext.Template("<li>",'<a href="{link}" title="{desc}" target="_blank">','{title}<span class="feedItemDate"> - {date}</span>',"</a>","</li>");for(var e=0,a=c.length;e<a;++e){var g=c[e];var d=this.convertDate(g.updated);f+=b.applyTemplate({title:g.title,desc:g.summary,link:g.link,date:this.getTimeDiff(d)})}f+="</ul>";return f},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({title:c.title,desc:c.summary,img:this.portalUrl+"/default_news.png",link:c.link,date:this.getTimeDiff(j)}));d.push('<div class="right">');var h=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>",'<div class="description">',"<p>{desc}</p>","</div>","</div>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({title:k.title,desc:k.summary,img:this.portalUrl+"/default_news.png",link:k.link,date:this.getTimeDiff(j)}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(){var c=this.entries;var d=this.getId()+"_slideshow";var g=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<div class="description">','<small class="feedItemDate">{date}</small>',"<p>{desc}</p>","</div>","</div>","</div>");for(var f=0,a=c.length;f<a;++f){var h=c[f];var e=this.convertDate(h.updated);g.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:h.title,desc:h.summary,link:h.link,date:this.getTimeDiff(e)}))}g.push("</div>");return g.join("")},buildHeadlineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<small class="feedItemDate">{date}</small>',"</div>","</div>",'<div class="middle odd">','<div class="description">{desc}</div>',"</div>");var c=e[0];var j=this.convertDate(c.updated);d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.summary,link:c.link,date:this.getTimeDiff(j)}));d.push('<ul class="bottom">');var h=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}<small class="feedItemDate">{date}</small></a></h3>','<p class="description">{desc}</p>',"</li>");for(var b=1,g=e.length;b<g;++b){var k=e[b];var j=this.convertDate(k.updated);d.push(h.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:k.title,desc:k.summary,link:k.link,date:this.getTimeDiff(j)}))}d.push("</ul></div>");return d.join("")},convertDate:function(a){var b=null;if(a){b=a.split("-").join("/")}return b},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+_("days before")}else{if(f>0){a=f+_("hours before")}else{if(b>0){a=b+_("minutes before")}}}return a}});Ext.reg("widget_rss",Anz.widget.rss);
/* - widget_weather.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.weather=Ext.extend(Anz.widget.base,{iconCls:"widget_weather_icon",getCustomisePreferences:function(){return[{xtype:"widget.weather.woeidfield",name:"woeid",fieldLabel:_("City"),value:""},{xtype:"combo",name:"units",hiddenName:"units",fieldLabel:_("Units"),value:"c",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["c",_("Celsius")],["f",_("Fahrenheit")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Compact",_("Compact")],["Today",_("Today")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.woeid;var e=a.units;var b=a.view;if(d!==c.woeid){this.display()}else{if(e!==c.units){this.display()}else{if(b!==c.view){this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');var a=this.getValue("feed");Ext.Ajax.request({url:this.contextUrl+"/@@weatherWidget/weather",method:"POST",params:{woeid:this.options.woeid,units:this.options.units},timeout:5000,scope:this,success:function(b,f){var d=Ext.decode(b.responseText);if(d.success){var g=d.info;var c=this.options.view;var e=this.buildContents(g,c);this.body.update(e);this.loaded=true}else{if(d.msg){this.body.update(d.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(b,d){var c=b.responseText;if(c){this.body.update(c.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},buildContents:function(a,b){var c=null;switch(b){case"Compact":c=this.buildCompactHtml(a);break;case"Today":c=this.buildTodayHtml(a);break;default:c=this.buildTodayHtml(a)}return c},buildTodayHtml:function(b){var a=new Ext.Template('<div class="yw-forecast">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="yw-date">{time}</div>','<div class="yw-cond">{condition_text}</div>',"<dl>","<dt>{Feels_Like}:</dt><dd>{temp}&deg;{temp_unit}</dd>","<dt>{Barometer}:</dt><dd>{pressure} {pressure_unit}</dd>","<dt>{Humidity}:</dt><dd>{humidity} %</dd>","<dt>{Visibility}:</dt><dd>{visibility} {visibility_unit}</dd>","<dt>{Wind}:</dt><dd>{wind_direction} {wind_speed} {speed_unit}</dd>","<dt>{Sunrise}:</dt><dd>{sunrise}</dd>","<dt>{Sunset}:</dt><dd>{sunset}</dd>","</dl>",'<div class="forecast-icon" style="background: transparent url(weather/{code}d-s.png) no-repeat scroll 0% 0%;"></div>','<div class="forecast-temp">','<div class="yw-temp">{temp}&deg;</div>',"<p>{High}: {high_temp}&deg; {Low}: {low_temp}&deg;</p>","</div>","</div>");return a.applyTemplate({Feels_Like:_("Feels Like"),Barometer:_("Barometer"),Humidity:_("Humidity"),Visibility:_("Visibility"),Wind:_("Wind"),Sunrise:_("Sunrise"),Sunset:_("Sunset"),High:_("High"),Low:_("Low"),location:b.location.city+","+b.location.country,time:b.condition.date,condition_text:this._conditionMap()[b.condition.code],temp:b.condition.temp,temp_unit:b.units.temperature,pressure:b.atmosphere.pressure,pressure_unit:b.units.pressure,humidity:b.atmosphere.humidity,visibility:b.atmosphere.visibility,visibility_unit:b.units.distance,wind_direction:b.wind.direction,wind_speed:b.wind.speed,speed_unit:b.units.speed,sunrise:b.astronomy.sunrise,sunset:b.astronomy.sunset,high_temp:b.forecast[0].high,low_temp:b.forecast[0].low,code:b.condition.code,link:b.link,Detailed_Forecast:_("Detailed Forecast")})},buildCompactHtml:function(b){var a=new Ext.Template('<div class="weather-compact">','<div class="yw-loc">','<a target="_blank" href="{link}">{location}</a>',"</div>",'<div class="today-weather">','<div class="weather-icon">','<img src="weather/{today_code}d-s.png" title="{today_code_text}" alt="{condition_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{today_date}<br>{today_weekday}</span>','<span class="weather-temp">{today_low_temp}/{today_high_temp}&deg;</span>',"</div>","</div>",'<div class="tomorrow-weather">','<div class="weather-icon">','<img src="weather/{next_code}d-s.png" title="{next_code_text}" alt="{next_code_text}">',"</div>",'<div class="weather-text">','<span class="weather-day">{next_weekday}</span>','<span class="weather-temp">{next_low_temp}/{next_high_temp}&deg;</span>',"</div>","</div>","</div>");return a.applyTemplate({link:b.link,location:b.location.city+","+b.location.country,today_code:b.forecast[0].code,today_code_text:this._conditionMap()[b.forecast[0].code],today_low_temp:b.forecast[0].low,today_high_temp:b.forecast[0].high,today_date:b.forecast[0].date,today_weekday:_(b.forecast[0].day),next_code:b.forecast[1].code,next_code_text:this._conditionMap()[b.forecast[1].code],next_low_temp:b.forecast[1].low,next_high_temp:b.forecast[1].high,next_date:b.forecast[1].date,next_weekday:_(b.forecast[1].day)})},_conditionMap:function(){return{"0":_("Tornado"),"1":_("Tropical storm"),"2":_("Hurricane"),"3":_("Severe thunderstorms"),"4":_("Thunderstorms"),"5":_("Mixed rain and snow"),"6":_("Mixed rain and sleet"),"7":_("Mixed snow and sleet"),"8":_("Freezing drizzle"),"9":_("Drizzle"),"10":_("Freezing rain"),"11":_("Showers"),"12":_("Showers"),"13":_("Snow flurries"),"14":_("Light snow showers"),"15":_("Blowing snow"),"16":_("Snow"),"17":_("Hail"),"18":_("Sleet"),"19":_("Dust"),"20":_("Foggy"),"21":_("Haze"),"22":_("Smoky"),"23":_("Blustery"),"24":_("Windy"),"25":_("Cold"),"26":_("Cloudy"),"27":_("Mostly cloudy"),"28":_("Mostly cloudy"),"29":_("Partly cloudy"),"30":_("Partly cloudy"),"31":_("Clear"),"32":_("Sunny"),"33":_("Fair"),"34":_("Fair"),"35":_("Mixed rain and hail"),"36":_("Hot"),"37":_("Isolated thunderstorms"),"38":_("Scattered thunderstorms"),"39":_("Scattered thunderstorms"),"40":_("Scattered showers"),"41":_("Heavy snow"),"42":_("Scattered snow showers"),"43":_("Heavy snow"),"44":_("Partly cloudy"),"45":_("Thundershowers"),"46":_("Snow showers"),"47":_("Isolated thundershowers")}}});Ext.reg("widget_weather",Anz.widget.weather);Anz.widget.weather.woeidfield=function(b){var c=new Ext.data.Store({proxy:new Ext.data.ScriptTagProxy({url:"http://where.yahooapis.com/v1",listeners:{beforeload:{scope:this,fn:function(e,f){e.setApi(Ext.data.Api.actions.read,String.format("http://where.yahooapis.com/v1/places.q({0});count=0?format=json&appid=1dIus9DV34GjOFTpNt_pwV465FOtJItUDeDMDR2bLWox6hTqUHPrVtvCnvDBfYg-",f.query))}}}}),reader:new Ext.data.JsonReader({root:"places.place",id:"woeid"},[{name:"woeid",mapping:"woeid"},{name:"name",mapping:"name"}])});var d=new Ext.XTemplate('<tpl for="."><div class="search-item">',"<h3><span>{woeid}-{name}</span></h3>","</div></tpl>");var a={store:c,displayField:"title",typeAhead:false,loadingText:"Searching...",width:570,hideTrigger:true,tpl:d,itemSelector:"div.search-item",listeners:{select:{scope:this,fn:function(g,e,f){g.setValue(e.get("woeid"))}}}};if(b){Ext.apply(a,b)}Ext.apply(this,a);Anz.widget.weather.woeidfield.superclass.constructor.apply(this,arguments)};Ext.extend(Anz.widget.weather.woeidfield,Ext.form.ComboBox,{});Ext.reg("widget.weather.woeidfield",Anz.widget.weather.woeidfield);
/* - widget_calendar.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.calendar=Ext.extend(Anz.widget.base,{iconCls:"widget_calendar_icon",bodyStyle:"padding: 5px",view:"Month",tips:[],tipsCfg:[],getCustomisePreferences:function(){return[{xtype:"combo",name:"weekStart",hiddenName:"weekStart",fieldLabel:_("Start day of week"),value:"Mon",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Sun",_("Sun")],["Mon",_("Mon")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Month",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Month",_("Month")],["Week",_("Week")],["Agenda",_("Agenda")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{view:"Month",weekStart:"Mon"}},updateOptions:function(c){var a=this.options;this.options=c;this.setTitle(Utf8.decode(c.title));if(!this.collapsed){var d=a.weekStart;var b=a.view;if(d!==c.weekStart){this.display()}else{if(b!==c.view){this.display()}}}},display:function(c){this.body.update('<div class="loading-indicator">Loading...</div>');if(!c){c=new Date()}this.view=this.getValue("view");this.weekStart=this.getValue("weekStart");var d=null;var a=null;switch(this.view){case"Month":d=c.getFirstDateOfMonth();a=c.getLastDateOfMonth();break;case"Week":case"Agenda":var b=c.format("w");if(this.weekStart=="Sun"){d=c.add(Date.DAY,-b)}else{if(b==0){d=c.add(Date.DAY,-6)}else{d=c.add(Date.DAY,1-b)}}a=d.add(Date.DAY,6);break;default:break}Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["events@@calendarWidget/events?start:date="+d.format("Y/m/d")+"&end:date="+a.format("Y/m/d"),"stateStr@@calendarWidget/getReviewStateString"]},timeout:5000,scope:this,success:function(f,i){var g=Ext.decode(f.responseText);var j=g.events;if(j.success){this.eventsInfo=j.events;this.startDate=d;var e=g.stateStr;if(e.success){this.stateStr=e.stateStr}var h=this.buildContents();this.destroyEventTips();this.body.update(h);this.createEventTips();this.attachListener();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(e,g){var f=e.responseText;if(f){this.body.update(f.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachListener:function(){var a=this.view;switch(a){case"Month":this.buildMonthListener();break;case"Week":case"Agenda":this.buildWeekListener();break;default:break}},destroyEventTips:function(){var b=this.tips;for(var c=0,a=b.length;c<a;++c){Ext.QuickTips.unregister(b[c].target)}this.tips=[]},createEventTips:function(){var e=this.tipsCfg;for(var c=0,a=e.length;c<a;++c){var b=e[c];var d=new Ext.ToolTip({target:b.target,title:_("Events in this day"),width:"auto",dismissDelay:0,html:b.html,trackMouse:true});this.tips.push(d)}this.tipsCfg=[]},buildMonthListener:function(){var a=this.body.child("a[class=preTimeCycle]");a.on("click",this.preMonth,this);var b=this.body.child("a[class=nextTimeCycle]");b.on("click",this.nextMonth,this)},preMonth:function(){var a=this.startDate.add(Date.MONTH,-1);this.display(a)},nextMonth:function(){var a=this.startDate.add(Date.MONTH,1);this.display(a)},buildWeekListener:function(){var b=this.body.child("a[class=preTimeCycle]");b.on("click",this.preWeek,this);var a=this.body.child("a[class=nextTimeCycle]");a.on("click",this.nextWeek,this)},preWeek:function(){var a=this.startDate.add(Date.DAY,-7);this.display(a)},nextWeek:function(){var a=this.startDate.add(Date.DAY,7);this.display(a)},buildContents:function(){var a=this.view;var b=null;switch(a){case"Month":b=this.buildMonthHtml();break;case"Week":b=this.buildWeekHtml();break;case"Agenda":b=this.buildAgendaHtml();break;default:b=this.buildMonthHtml()}return b},buildMonthHtml:function(){var d=this.eventsInfo;var u=this.weekStart;var e=this.startDate;var m=e.getFirstDayOfMonth();var f=e.getLastDayOfMonth();var q=0;var s=0;if(u==="Sun"){q=m;s=6-f}else{if(m===0){q=6;s=0}else{q=m-1;s=7-f}}var r=e.getDaysInMonth();var h=[];for(var z=0;z<q;++z){h.push(0)}for(var z=1;z<=r;++z){h.push(z)}for(var z=0;z<s;++z){h.push(0)}var l=[];var y=new Ext.Template('<div class="calendar_month_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{month}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(u==="Sun"){l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{l.push(y.applyTemplate({month:e.format("Y-m"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="{dateCls}" id="date_{id}">{day}</td>');var C=new Ext.Template('<td class="{dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var w=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var z=0,A=h.length;z<A;++z){if((z%7)==0){l.push("<tr>")}var x=h[z];if(x==0){l.push('<td class="blank_day"></td>')}else{var o=e.add(Date.DAY,x-1);var n=o.format("w");var p=false;if(n==0||n==6){p=true}var c=d[o.format("Ymd")];var g=c&&c.length;if(g){var b=o.format("Y/m/d");l.push(C.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x,url:this.portalUrl+"/search?"+this.stateStr+"start.query:record:list:date="+b+"+23%3A59%3A59&amp;start.range:record=max&amp;end.query:record:list:date="+b+"+00%3A00%3A00&amp;end.range:record=min"}));var t=[];for(var v=0,k=c.length;v<k;++v){var B=c[v];t.push(w.applyTemplate({title:B.title,start:B.start,end:B.end,desc:B.desc}))}this.tipsCfg.push({target:"date_"+o.format("Y_m_d"),html:t.join("")})}else{l.push(a.applyTemplate({dateCls:p?"weekend":"",id:o.format("Y_m_d"),day:x}))}}if((z%7)==6){l.push("</tr>")}}l.push("</tbody></table></div>");return l.join("")},buildWeekHtml:function(){var b=this.eventsInfo;var n=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<table class="calendar_table">',"<thead><tr>",'<td class="theader">{day1}</td>','<td class="theader">{day2}</td>','<td class="theader">{day3}</td>','<td class="theader">{day4}</td>','<td class="theader">{day5}</td>','<td class="theader">{day6}</td>','<td class="theader">{day7}</td>',"</tr></thead>","<tbody>");if(n==="Sun"){h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Sun"),day2:_("Mon"),day3:_("Tue"),day4:_("Wed"),day5:_("Thu"),day6:_("Fri"),day7:_("Sat")}))}else{h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d"),day1:_("Mon"),day2:_("Tue"),day3:_("Wed"),day4:_("Thu"),day5:_("Fri"),day6:_("Sat"),day7:_("Sun")}))}var a=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">{day}</td>');var u=new Ext.Template('<td class="weekDay {dateCls}" id="date_{id}">','<a target="_blank" href="{url}">{day}</a>','<img index="0" class="event" src="ext3/resources/images/default/s.gif">',"</td>");var q=new Ext.Template('<div class="eventCls"><h6>{title}   {start}-{end}</h6><p>{desc}</p></div>');for(var s=0;s<7;++s){var l=e.add(Date.DAY,s);var k=l.format("w");var m=false;if(k==0||k==6){m=true}var c=b[l.format("Ymd")];var f=c&&c.length;if(f){h.push(u.applyTemplate({dateCls:m?"weekend":"",id:l.format("Y_m_d"),day:l.format("d"),url:""}));var o=[];for(var p=0,g=c.length;p<g;++p){var t=c[p];o.push(q.applyTemplate({title:t.title,start:t.start,end:t.end,desc:t.desc}))}this.tipsCfg.push({target:"date_"+l.format("Y_m_d"),html:o.join("")})}else{h.push(a.applyTemplate({dateCls:m?"weekend":"",id:l.format("Y_m_d"),day:l.format("d")}))}}h.push("</tbody></table></div>");return h.join("")},buildAgendaHtml:function(){var b=this.eventsInfo;var o=this.weekStart;var e=this.startDate;var d=e.add(Date.DAY,6);var h=[];var r=new Ext.Template('<div class="calendar_week_view">','<table class="calendar_header_table"><tbody><tr>','<td class="alignLeft"><a class="preTimeCycle">&lt;&lt;</a></td>','<td class="alignCenter">{range}</td>','<td class="alignRight"><a class="nextTimeCycle">&gt;&gt;</a></td>',"</tr></tbody></table>",'<div class="">');h.push(r.applyTemplate({range:e.format("Y/m/d")+" - "+d.format("Y/m/d")}));var q=new Ext.Template('<div class="{eventCls}">','<span class="{dateCls}">{date}</span>','<span class="dayCls">{day}</span>','<a target="_blank" href="{url}" title="{desc}">{title}</a>',"</div>");var u=new Ext.Template('<div class="{eventCls}">','<span class="dateCls">{date}</span>','<span class="dayCls">{day}</span>','<span class="hint">{title}</span>',"</div>");for(var s=0;s<7;++s){var m=e.add(Date.DAY,s);var k=m.format("w");var n=false;if(k==0||k==6){n=true}var l=m.format("Y/m/d");var a=m.format("D");var c=b[m.format("Ymd")];var f=c&&c.length;if(f){for(var p=0,g=c.length;p<g;++p){var t=c[p];h.push(q.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",dateCls:p==0?"dateCls":"dateHidden",dayCls:p==0?"dayCls":"dayHidden",date:l,day:_(a),url:t.url,title:t.title,desc:t.start+"-"+t.end+"    "+t.title}))}}else{h.push(u.applyTemplate({eventCls:n?"eventItem weekend":"eventItem",date:l,day:_(a),title:_("No event today.")}))}}h.push("</div></div>");return h.join("")}});Ext.reg("widget_calendar",Anz.widget.calendar);
/* - widget_folder_contents.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.widget");Anz.widget.folderContents=Ext.extend(Anz.widget.base,{iconCls:"widget_folder_contents_icon",entries:[],page:0,pageCount:1,count:null,getCustomisePreferences:function(){var a=this.portalUrl.split("/").pop();return[{xtype:"treecombosuperbox",name:"paths",fieldLabel:_("Paths"),hiddenName:"paths:list",navigateItemsWithTab:true,resizable:true,allowBlank:false,msgTarget:"under",displayFieldTpl:"{text}",value:"/"+a,multiSelect:true,treeWidth:353,treeConfig:{height:110,rootVisible:true,autoScroll:true,root:{nodeType:"async",text:_("Root"),id:"root",expanded:true,path:"/"+a},loader:{url:this.contextUrl+"/@@folderContentsWidget/getChildNodesData"},listeners:{beforeload:{fn:function(c){var b=c.getOwnerTree().getLoader();b.baseParams.path=c.attributes.path}},click:{fn:function(d,g){var c=d.attributes.path;var i=d.text;var b=this.getCaption(d);var h="";var f="";this.addItemBox(c,i,b,h,f)}}}}},{xtype:"xcheckbox",name:"searchSub",fieldLabel:_("Search sub-directory?"),submitOffValue:0,submitOnValue:1,value:0,hiddenName:"searchSub:int"},{xtype:"multiselect",fieldLabel:_("Types"),name:"types",width:360,height:"auto",allowBlank:true,displayField:"name",valueField:"id",store:new Ext.data.JsonStore({autoDestroy:true,autoLoad:true,url:this.contextUrl+"/@@folderContentsWidget/types",root:"types",fields:["id","name"]})},{xtype:"numberfield",name:"recentDays",fieldLabel:_("Recent days"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"numberfield",name:"sort_limit",fieldLabel:_("Max count"),value:0,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"xcheckbox",name:"paging",fieldLabel:_("Paging?"),submitOffValue:0,submitOnValue:1,value:1,hiddenName:"paging:int"},{xtype:"numberfield",name:"count",fieldLabel:_("Count"),value:5,allowBlank:false,allowDecimals:false,allowNegative:false},{xtype:"combo",name:"view",hiddenName:"view",fieldLabel:_("View"),value:"Normal",mode:"local",store:{xtype:"arraystore",fields:["id","name"],data:[["Normal",_("Normal")],["Magazine",_("Magazine")],["Slideshow",_("Slideshow")],["Headline",_("Headline")]]},displayField:"name",valueField:"id",triggerAction:"all",editable:false}]},getDefaultValues:function(){return{searchSub:0,recentDays:0,sort_limit:0,count:5,paging:1,view:"Normal"}},updateOptions:function(i){var a=this.options;this.options=i;this.count=parseInt(this.getValue("count"));this.setTitle(Utf8.decode(this.getValue("title")));if(!this.collapsed){var c=a.paths;var g=a.types;var d=a.searchSub;var h=a.recentDays;var e=a.sort_limit;var f=a.view;var b=a.paging;if((c!==this.getValue("paths"))||(g!==this.getValue("types"))||(d!==this.getValue("searchSub"))||(h!==this.getValue("recentDays"))||(e!==this.getValue("sort_limit"))){this.display()}else{if((f!==this.getValue("view"))||(b!==this.getValue("paging"))){if(this.loaded){this.buildContents()}else{this.display()}}}}},display:function(){this.body.update('<div class="loading-indicator">Loading...</div>');this.loaded=false;var d=this.getValue("paths");var b=this.getValue("types");var c=this.getValue("searchSub");var e=this.getValue("recentDays");var a=this.getValue("sort_limit");Ext.Ajax.request({url:this.contextUrl+"/@@folderContentsWidget/items",method:"POST",params:{"paths:list":d,searchSub:c,portal_types:b,"recentDays:int":e,"sort_limit:int":a},timeout:5000,scope:this,success:function(f,h){var g=Ext.decode(f.responseText);if(g.success){this.entries=g.items;this.count=parseInt(this.getValue("count"));this.pageCount=Math.ceil(this.entries.length/this.count);this.buildContents();this.loaded=true}else{if(g.msg){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}},failure:function(f,h){var g=f.responseText;if(g){this.body.update(g.msg)}else{this.body.update(_("Sorry, get data fail, rettry later."))}this.retryDisplay()}})},attachPagingHandler:function(){var a=this.body.child("a[class=prePage]");if(a){a.on("click",this.prePage,this)}var b=this.body.child("a[class=nextPage]");if(b){b.on("click",this.nextPage,this)}},prePage:function(){this.page-=1;this.buildContents()},nextPage:function(){this.page+=1;this.buildContents()},buildContents:function(){var c="";var a=this.getValue("view");switch(a){case"Normal":c=this.buildNormalHtml();break;case"Magazine":c=this.buildMagazineHtml();break;case"Slideshow":c=this.buildSlideshowHtml();break;case"Headline":c=this.buildHeadlineHtml();break;default:c=this.buildNormalHtml()}var d=this.getValue("paging")&&(this.pageCount>1)&&(a!=="Slideshow");if(d){c+='<div class="paging-bottom">';if(this.page!==0){c+=String.format('<a class="prePage" href="javascript:;">{0}</a>',_("prev"))}if(this.page<this.pageCount-1){c+=String.format('<a class="nextPage" href="javascript:;">{0}</a>',_("next"))}c+="<div>"}this.body.update(c);if(a==="Slideshow"){var b=this.getId()+"_slideshow";new Ext.ux.Carousel(b,{itemSelector:"div.item",interval:10,autoPlay:true,transitionEasing:"easeIn"})}if(d){this.attachPagingHandler()}},buildNormalHtml:function(){var h=this.page*this.count;var c=this.entries.slice(h,h+this.count);var f='<ul class="itemList">';var b=new Ext.Template("<li>",'<img width="16" height="16" src="{iconSrc}">','<a href="{link}" title="{desc}" target="_blank">',"{title}","</a>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</li>");for(var e=0,a=c.length;e<a;++e){var g=c[e];var d="";if(g.icon){d=this.portalUrl+"/"+g.icon}f+=b.applyTemplate({iconSrc:d,title:g.title,desc:g.desc,link:g.url,authorLink:this.portalUrl+"/author/"+g.author_id,author:g.author,date:g.modified,shortDate:new Date(g.modified).format("Y/m/d")})}f+="</ul>";return f},buildMagazineHtml:function(){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="magazineView">'];var f=new Ext.Template('<div class="left">','<div class="crop">','<img height="234" width="234" src="{img}"/>',"</div>",'<div class="article">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");var c=e[0];d.push(f.applyTemplate({title:c.title,desc:c.desc,img:this.portalUrl+"/default_news.png",link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<div class="right">');var g=new Ext.Template('<div class="item">','<div class="thumbnail">','<img height="50" width="50" src="{img}"/>',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","<p>{desc}</p>","</div>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({title:j.title,desc:j.desc,img:this.portalUrl+"/default_news.png",link:j.link,authorLink:portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</div></div>");return d.join("")},buildSlideshowHtml:function(c){var c=this.entries;var d=this.getId()+"_slideshow";var f=[String.format('<div class="slideshowView" id="{0}">',d)];var b=new Ext.Template('<div class="item">','<div class="crop">','<img src="{img}">',"</div>",'<div class="content">','<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>',"</div>",'<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</div>","</div>");for(var e=0,a=c.length;e<a;++e){var g=c[e];f.push(b.applyTemplate({img:this.portalUrl+"/default_news.png",title:g.title,desc:g.desc,link:g.link,authorLink:this.portalUrl+"/author/"+g.author_id,author:g.author,date:g.modified,shortDate:new Date(g.modified).format("Y/m/d")}))}f.push("</div>");return f.join("")},buildHeadlineHtml:function(e){var a=this.page*this.count;var e=this.entries.slice(a,a+this.count);var d=['<div class="headlineView">'];var f=new Ext.Template('<div class="top">','<div class="crop">','<img height="234" width="234" src="{img}">',"</div>",'<div class="title">','<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","</div>","</div>",'<div class="middle odd">',"<p>{desc}</p>","</div>");var c=e[0];d.push(f.applyTemplate({img:this.portalUrl+"/default_news.png",title:c.title,desc:c.desc,link:c.link,authorLink:this.portalUrl+"/author/"+c.author_id,author:c.author,date:c.modified,shortDate:new Date(c.modified).format("Y/m/d")}));d.push('<ul class="bottom">');var g=new Ext.Template('<li class="item {cls}">','<div class="thumbnail">','<img height="50" width="50" src="{img}">',"</div>",'<h3><a href="{link}" target="_blank">{title}</a></h3>','<span class="byline">',' - <a href="{authorLink}" target="_blank">',"{author}","</a>",'<span title="{date}" class="itemDate"> - {shortDate}</span>',"</span>","<p>{desc}</p>","</li>");for(var b=1,h=e.length;b<h;++b){var j=e[b];d.push(g.applyTemplate({cls:b%2?"even":"odd",img:this.portalUrl+"/default_news.png",title:j.title,desc:j.desc,link:j.link,authorLink:this.portalUrl+"/author/"+j.author_id,author:j.author,date:j.modified,shortDate:new Date(j.modified).format("Y/m/d")}))}d.push("</ul></div>");return d.join("")},getTimeDiff:function(e){if(!e){return""}var d=new Date(e);var h=new Date();var c=h.valueOf()-d.valueOf();var i=c/86400000;i=parseInt(i);c=c-(i*86400000);var f=c/3600000;f=parseInt(f);c=c-(f*3600000);var b=c/60000;b=parseInt(b);c=c-(b*60000);var g=c/1000;g=parseInt(g);var a="";if(i>0){a=i+"days before"}else{if(f>0){a=f+"hours before"}else{if(b>0){a=b+"minutes before"}}}return a}});Ext.reg("widget_folder_contents",Anz.widget.folderContents);
/* - anz_dashboard_view.js - */
Ext.BLANK_IMAGE_URL="ext3/resources/images/default/s.gif";Ext.namespace("Anz","Anz.dashboard");Anz.dashboard.view=function(){return{portalUrl:null,contextUrl:null,container:null,init:function(b,a){Ext.QuickTips.init();this.portalUrl=b;this.contextUrl=a;Ext.Ajax.request({url:this.contextUrl+"/@@mergedRequest/getMergedData",method:"POST",params:{"requests:list":["pageLayout@@dashboardView/getPageLayout","layoutCfg@@dashboardView/getLayoutConfig","widgets@@widgetView/getWidgets","i18n@@msgCatalog/catalogMapping?domain=anz.dashboard"]},scope:this,success:function(m,d){var h=Ext.decode(m.responseText);var l=h.pageLayout.layout;var c=h.layoutCfg.config;Anz.i18n=h.i18n.texts;var k=h.widgets.widgets;var j={};for(var e=0,g=k.length;e<g;++e){var f=k[e];j[f.id]=f}this.constructPortal(l,c,j)},failure:function(c,d){alert(c.responseText)}})},destroy:function(){if(this.container){this.container.removeAll()}},constructPortal:function(s,v,q){var e={};var b="content";if(s==="tile"){Ext.apply(e,{renderTo:b})}else{var n=Ext.get(b);var r=n.getWidth(true);Ext.apply(e,{renderTo:b,activeTab:0,width:r,plain:true,defaults:{autoScroll:true}})}var m=[];for(var w=0,x=v.length;w<x;++w){var g=v[w];var l=g.columns.length;var y={};y.xtype="container";y.title=Utf8.decode(g.title);y.layout="column";y.border=false;y.autoHeight=true;var z=[];for(var u=0;u<l;++u){var d=g.columns[u];var h={};h.xtype="container",h.border=false;h.columnWidth=parseFloat(d.width);h.style=d.style;var o=[];var p=d.widgets;var c=p.length;for(var t=0;t<c;++t){var f=p[t];var a={};a.portalUrl=this.portalUrl;a.contextUrl=this.contextUrl;a.xtype=f.id;a.options=f.options;if(!(f.options.showTitle!==undefined&&f.options.showTitle===0)){a.title=Utf8.decode(f.options.title)}if(!f.collapse){a.collapsed=f.collapse;a.draggable=false;if(f.color){a.baseCls="x-panel-green"}if(q[f.id]){a.iconCls=q[f.id].icon}o.push(a)}}h.items=o;z.push(h)}y.items=z;m.push(y)}e.items=m;if(s==="tile"){this.container=new Ext.Container(e)}else{this.container=new Ext.TabPanel(e)}}}}();